"use strict";(self.webpackChunk_postman_app_scratchpad=self.webpackChunk_postman_app_scratchpad||[]).push([[10],{7442:function(e,t,s){s.r(t),s.d(t,{ACTION_TO_BUTTON_MAP:function(){return _},APPLICATION_JAVASCRIPT:function(){return ae},APPLICATION_JSON:function(){return te},APPLICATION_OCTET_STREAM:function(){return ne},APPLICATION_XML:function(){return se},COMPOSE_MESSAGE_BODY_SUBTYPE_MAP:function(){return j},COMPOSE_MESSAGE_BODY_TYPE_MAP:function(){return $},CONNECT:function(){return E},CONNECTED:function(){return u},CONNECTING:function(){return h},CONNECTION_EVENT_TO_HANDLER_MAP:function(){return pe},DISABLED_TOOLTIP_TEXT:function(){return fe},DISCONNECT:function(){return g},DISCONNECTING:function(){return m},EDITOR:function(){return re},IDLE:function(){return d},IFRAME:function(){return le},MESSAGE_BODY_SUB_TYPE_FLOATINT32ARRAY:function(){return Q},MESSAGE_BODY_SUB_TYPE_FLOATINT64ARRAY:function(){return J},MESSAGE_BODY_SUB_TYPE_INT16ARRAY:function(){return q},MESSAGE_BODY_SUB_TYPE_INT32ARRAY:function(){return z},MESSAGE_BODY_SUB_TYPE_INT8ARRAY:function(){return K},MESSAGE_BODY_SUB_TYPE_UINT16ARRAY:function(){return Y},MESSAGE_BODY_SUB_TYPE_UINT32ARRAY:function(){return V},MESSAGE_BODY_SUB_TYPE_UINT8ARRAY:function(){return H},MESSAGE_BODY_SUB_TYPE_UINT8CLAMPEDARRAY:function(){return F},MESSAGE_BODY_TYPE_ARRAY_BUFFER:function(){return U},MESSAGE_BODY_TYPE_AUDIO:function(){return x},MESSAGE_BODY_TYPE_HEXDUMP:function(){return W},MESSAGE_BODY_TYPE_HTML:function(){return B},MESSAGE_BODY_TYPE_IMAGE:function(){return G},MESSAGE_BODY_TYPE_JSON:function(){return P},MESSAGE_BODY_TYPE_TEXT:function(){return R},MESSAGE_BODY_TYPE_TO_MIME_TYPE_MAP:function(){return ie},MESSAGE_BODY_TYPE_VIDEO:function(){return L},MESSAGE_BODY_TYPE_XML:function(){return D},MESSAGE_ICON_MAP:function(){return w},MESSAGE_PREVIEW_TRUNCATE_THRESHOLD:function(){return he},MESSAGE_STREAM_NOTIFICATION_JUMP_TO_LATEST:function(){return ye},MESSAGE_STREAM_NOTIFICATION_NEW:function(){return Te},MESSAGE_TYPE_FILTER_LABELS:function(){return k},MIME_TYPE_TO_MESSAGE_BODY_TYPE_MAP:function(){return oe},RECONNECTING:function(){return p},TEXT_HTML:function(){return ee},TEXT_PLAIN:function(){return Z},TYPED_ARRAY_CONSTRUCTOR_MAP:function(){return X},WEBSOCKET_ABORT_MESSAGE:function(){return M},WEBSOCKET_ALL_MESSAGES:function(){return N},WEBSOCKET_CONNECTED_MESSAGE:function(){return v},WEBSOCKET_CONNECTION_CLOSE_CODES:function(){return ge},WEBSOCKET_CONNECTION_HEADERS:function(){return r},WEBSOCKET_CONNECTION_QUERY_PARAMS:function(){return c},WEBSOCKET_CONNECTION_SETTINGS:function(){return l},WEBSOCKET_DISCONNECTED_MESSAGE:function(){return b},WEBSOCKET_ERROR_MESSAGE:function(){return O},WEBSOCKET_HIDDEN_MESSAGE:function(){return A},WEBSOCKET_INCOMING_MESSAGE:function(){return f},WEBSOCKET_MESSAGES:function(){return i},WEBSOCKET_MESSAGE_READABLE:function(){return de},WEBSOCKET_MESSAGE_STREAM_STATUS:function(){return _e},WEBSOCKET_MESSAGE_SUPPORTED_MEDIA_TYPES:function(){return ce},WEBSOCKET_MESSAGE_VIEWER_MAP:function(){return ue},WEBSOCKET_META_MESSAGES:function(){return I},WEBSOCKET_OUTGOING_MESSAGE:function(){return T},WEBSOCKET_RECONNECTING_MESSAGE:function(){return C},WEBSOCKET_SCRIPTS:function(){return o},WEBSOCKET_STATUS_TO_ACTION_MAP:function(){return S},WEBSOCKET_STATUS_TO_BADGE_MAP:function(){return y},WS_CONNECTION_CONFIG:function(){return me},WS_CONNECTION_STATS_TEMPLATE:function(){return Ee},WS_REQUEST_ENABLED_DESKTOP_AGENT_VERSION:function(){return Se}});var a=s(2083),n=s.n(a);const i="messages",o="scripts",r="headers",l="settings",c="queryParams",d="idle",u="connected",h="connecting",p="reconnecting",m="disconnecting",E="connect",g="disconnect",S={[d]:E,[h]:g,[u]:g,[m]:E,[p]:g},_={[E]:{label:"Connect",handler:"connect"},[g]:{label:"Disconnect",handler:"disconnect"}},y={[d]:{label:"Disconnected",type:"critical"},[h]:{label:"Connecting",type:"info"},[u]:{label:"Connected",type:"success"},[m]:{label:"Disconnecting",type:"info"},[p]:{label:"Reconnecting",type:"info"}},T="outgoing",f="incoming",v="meta_connected",b="meta_disconnected",C="meta_reconnecting",M="meta_abort",O="meta_error",A="hidden",N="all",I=[v,b,C,M,O],w={[T]:{name:"icon-direction-ascend-small",color:"content-color-warning",size:"small"},[f]:{name:"icon-direction-descend-small",color:"content-color-info",size:"small"},[O]:{name:"icon-state-error-stroke",color:"content-color-error",size:"large"},[v]:{name:"icon-state-success-stroke",color:"content-color-success",size:"large"},[C]:{name:"icon-state-info-stroke",color:"content-color-primary",size:"large"},[M]:{name:"icon-state-info-stroke",color:"content-color-primary",size:"large"},[b](e){return e?{name:"icon-state-info-stroke",color:"content-color-primary",size:"large"}:{name:"icon-state-error-stroke",color:"content-color-error",size:"large"}}},k={[N]:"All Messages",[T]:"Sent",[f]:"Received"},R="text",P="postman_json",D="xml",B="html",W="hexdump",L="video",x="audio",G="image",U="array-buffer",K="Int8Array",H="Uint8Array",F="Uint8ClampedArray",q="Int16Array",Y="Uint16Array",z="Int32Array",V="Uint32Array",Q="Float32Array",J="Float64Array",$={[R]:"Text",[P]:"JSON",[D]:"XML",[B]:"HTML",[U]:"Array Buffer"},j={[K]:[K],[H]:[H],[F]:[F],[q]:[q],[Y]:[Y],[z]:[z],[V]:[V],[Q]:[Q],[J]:[J]},X={[K]:{constructor:Int8Array,multiple:1},[H]:{constructor:Uint8Array,multiple:1},[F]:{constructor:Uint8ClampedArray,multiple:1},[q]:{constructor:Int16Array,multiple:2},[Y]:{constructor:Uint16Array,multiple:2},[z]:{constructor:Int32Array,multiple:4},[V]:{constructor:Uint32Array,multiple:4},[Q]:{constructor:Float32Array,multiple:4},[J]:{constructor:Float64Array,multiple:8}},Z="text/plain",ee="text/html",te="application/json",se="application/xml",ae="application/javascript",ne="application/octet-stream",ie={[R]:Z,[B]:ee,[P]:te,[D]:se,[U]:ne},oe={[Z]:R,[ee]:B,[te]:P,[se]:D,[ne]:W},re="editor",le="iframe",ce=new Set([L,x,G]),de=new Set([Z,ee,te,se,ae]),ue={[re]:de,[le]:ce},he=200,pe={open:"onOpen",upgrade:"onUpgrade",message:"onMessage",close:"onClose",error:"onError",reconnect:"onReconnect",end:"onEnd"},me=[{id:"handshakeTimeout",title:"Handshake request timeout",description:"Set how long the handshake request should wait before timing out in milliseconds. To never time out, set to 0.",inputFieldType:"input",inputType:"number",defaultValue:0},{id:"retryCount",title:"Reconnection attempts",description:"Maximum reconnection attempts when the connection closes abruptly.",inputFieldType:"input",inputType:"number",defaultValue:0},{id:"retryDelay",title:"Reconnection intervals",description:"Interval between each reconnection attempt in milliseconds.",inputFieldType:"input",inputType:"number",defaultValue:5e3},{id:"maxPayload",title:"Maximum message size",description:"Maximum allowed message size in MB. To receive messages of any size, set to 0.",inputFieldType:"input",inputType:"number",defaultValue:10}],Ee=[{section:"Connection Details",dataFields:[{key:"connectedOn",label:"Connected",formatter:e=>n()(e).format("MMM Do YYYY,  HH:mm")},{label:"Protocol",key:"protocol"},{label:"Extensions",key:"extensions"}]}],ge={1e3:{code:1e3,name:"Normal Closure",description:"Connection was closed successfully."},1001:{code:1001,name:"Going Away",description:"Either because of a server failure or because the client is navigating away."},1002:{code:1002,name:"Protocol Error",description:"Endpoint terminated the connection due to a protocol error."},1003:{code:1003,name:"Unsupported Data",description:"Endpoint received data of a type it cannot accept."},1005:{code:1005,name:"No Status Received",description:"Missing status code even though one was expected."},1006:{code:1006,name:"Abnormal Closure",description:"No close frame was received."},1007:{code:1007,name:"Invalid Frame",description:"Endpoint received inconsistent data."},1008:{code:1008,name:"Policy Violation",description:"Endpoint received a message that violates its policy."},1009:{code:1009,name:"Message too big",description:"Endpoint received a data frame that was too large."},1010:{code:1010,name:"Missing Extension",description:"Server did not negotiate one or more extension expected by client."},1011:{code:1011,name:"Server Error",description:"Internal server error while operating."},1012:{code:1012,name:"Service Restart",description:"Server is restarting."},1013:{code:1013,name:"Try Again Later",description:"Temporary server error while operating."},1014:{code:1014,name:"Bad Gateway",description:"Server acting as gateway received an invalid response."},1015:{code:1015,name:"TLS Handshake",description:"Failure while performing the TLS handshake."},unknown(e,t){return{code:e||"Unknown",name:"Error",description:t||"Connection was closed due to an unknown error."}}},Se="0.3.5",_e={Ready:"ready",Loading:"loading",Error:"error",Empty:"empty"},ye="jump-to-latest",Te="new-messages",fe={noPermission:"You don't have permission to connect with a WebSocket server in this workspace.",notMember:"Only workspace members can connect with a WebSocket server. Join this workspace to complete this action.",emptyURL:"URL cannot be empty",nonWsAgent:"Switch to Postman Desktop Agent to connect with a WebSocket server.",agentNotConnected:"Make sure the Desktop Agent is installed and running.",oldAgent:"Youâ€™re using an older version of Postman Desktop Agent which does not support WebSocket requests. Update the Desktop Agent and try again."}},7440:function(e,t,s){s.r(t),s.d(t,{arrayBufferToString:function(){return T},createMessage:function(){return N},deserializeMessageData:function(){return B},deserializeMessages:function(){return W},getConnectionCloseInfo:function(){return A},getHeadersKeySuggestions:function(){return k},getHistoryMeatFromRequest:function(){return R},getMessagePreview:function(){return O},isConnectDisabled:function(){return w},isNormalConnectionClose:function(){return I},parseIncomingOrOutgoingMessage:function(){return L},parseSentOrReceviedMessageEvent:function(){return x},prepareHandshakeConfiguration:function(){return b},prepareHandshakeDetails:function(){return C},serializeMessageData:function(){return P},serializeMessages:function(){return D},stringToArrayBuffer:function(){return y},transformMessage:function(){return M}});var a=s(4993),n=s(9),i=s.n(n),o=s(1434),r=s.n(o),l=s(1187),c=s(1822),d=s(7441),u=s(2090),h=s(7442),p=(s(1703),s(12));const m=1e3,E={caps:"upper",format:"twos"},g=1048576,S="sec-websocket-protocol";function _(e,t=!0){return new l.HeaderList({},e).toObject(!0,t)}function y(e,t){const{constructor:s,multiple:a}=h.TYPED_ARRAY_CONSTRUCTOR_MAP[t],n=new ArrayBuffer(e.length*a),i=new s(n);for(let t=0,s=e.length;t<s;t++)i[t]=e.charCodeAt(t);return n}function T(e){let t="";for(let s=0,a=e.length;s<a;s++)t+=String.fromCharCode(e[s]);return t}function f(e){const t=p.reduce(h.WS_CONNECTION_CONFIG,((e,t)=>(e[t.id]=t.defaultValue,e)),{}),s=p.assign({},t,e);return s.maxPayload*=g,s}function v(e){const t=p.keys(e);for(let s=t.length-1;s>=0;s--)if(p.toLower(t[s])===S)return e[t[s]]}async function b(e){const t=function(e){return _(p.map(e,(e=>({key:e.key,value:e.value,disabled:!1===e.enabled}))))}(e.headers);return(0,d.resolveWSRequest)({url:e.url,protocols:v(t),headers:t,options:f(e.settings)})}function C(e,t){const s={};return e&&!p.isNil(e.href)&&(s["Request URL"]=e.href),e&&!p.isNil(e.method)&&(s["Request Method"]=e.method),t&&!p.isNil(t.statusCode)&&(s["Status Code"]=`${t.statusCode} ${t.statusMessage}`),e&&!p.isNil(e.headers)&&(s["Request Headers"]=_(e.headers)),t&&!p.isNil(t.headers)&&(s["Response Headers"]=_(t.headers)),p.isEmpty(s)?null:s}function M(e,t,s){let n,i;return h.WEBSOCKET_MESSAGE_VIEWER_MAP[h.IFRAME].has(p.toLower(p.split(t,"/")[0]))?(i=h.IFRAME,n=e):h.WEBSOCKET_MESSAGE_VIEWER_MAP[h.EDITOR].has(t)?(i=h.EDITOR,n=s?(0,a.hexy)(e,E):e):(i=h.EDITOR,e instanceof ArrayBuffer&&(e=new Uint8Array(e)),n=s?(0,a.hexy)(Array.from(e),E):String.fromCharCode.apply(null,e)),{message:n,viewer:i}}function O(e,{message:t,mimeType:s,url:a}={}){switch(e){case h.WEBSOCKET_CONNECTED_MESSAGE:return`Connected to ${a}`;case h.WEBSOCKET_DISCONNECTED_MESSAGE:return`Disconnected from ${a}`;case h.WEBSOCKET_RECONNECTING_MESSAGE:return`Reconnecting to ${a}`;case h.WEBSOCKET_ABORT_MESSAGE:return"Connection aborted";case h.WEBSOCKET_ERROR_MESSAGE:return`Could not connect to ${a}`;case h.WEBSOCKET_INCOMING_MESSAGE:case h.WEBSOCKET_OUTGOING_MESSAGE:{if(p.isNil(t)&&p.isNil(s)||!t)return{text:"(empty)",placeholder:!0};const e=p.toLower(p.split(s,"/")[0]);return h.WEBSOCKET_MESSAGE_SUPPORTED_MEDIA_TYPES.has(e)?{text:p.startCase(e),placeholder:!0,truncated:!1}:p.isString(t)&&h.WEBSOCKET_MESSAGE_READABLE.has(s)?{text:t.substring(0,h.MESSAGE_PREVIEW_TRUNCATE_THRESHOLD),placeholder:!1,truncated:t.length>h.MESSAGE_PREVIEW_TRUNCATE_THRESHOLD}:{text:"Binary",placeholder:!0,truncated:!1}}default:return""}}function A(e,t){if(!e)return null;const s=h.WEBSOCKET_CONNECTION_CLOSE_CODES[e];return s?{code:e,name:s.name,description:t||s.description}:h.WEBSOCKET_CONNECTION_CLOSE_CODES.unknown(e,t)}function N(e,t,s){if(!e)throw new Error("WebSocketRequestHelper~createMessage: Cannot create message without type");const a={id:i()(),type:e};return s&&(a.meta=s),t&&(a.payload=t),a}function I(e){return e===m}function w(e){if(!(0,u.isLoggedIn)())return(0,u.isWorkspaceMember)()&&p.isEmpty(e)?{isDisabled:!0,reason:h.DISABLED_TOOLTIP_TEXT.emptyURL}:{isDisabled:!1};let t;r().valid(r().coerce(pm.runtime.version));const s=(0,c.getStore)("PermissionStore").can("addHistory","workspace",(0,c.getStore)("ActiveWorkspaceStore").id),a=(0,u.isWorkspaceMember)()&&s,n=(0,u.canJoinWorkspace)(),i=Boolean(!a||p.isEmpty(e)&&(t=h.DISABLED_TOOLTIP_TEXT.emptyURL)||!1);return t||(!a&&n?t=h.DISABLED_TOOLTIP_TEXT.notMember:a||n||(t=h.DISABLED_TOOLTIP_TEXT.noPermission)),{isDisabled:i,reason:t}}function k(){return[{value:"Connection"},{value:"Cookie"},{value:"Host"},{value:"Origin"},{value:"Sec-WebSocket-Extensions"},{value:"Sec-WebSocket-Key"},{value:"Sec-WebSocket-Origin"},{value:"Sec-WebSocket-Protocol"},{value:"Sec-WebSocket-Version"},{value:"Upgrade"},{value:"User-Agent"}]}function R(e){return{url:(e=p.cloneDeep(e)).url,headers:e.headers||[],queryParams:e.queryParams||[],settings:e.settings||{},createdAt:(new Date).toISOString()}}function P(e){let t=e&&e.constructor.name;if(!t)return{payload:"",type:"String"};const s={type:t};switch(t){case"Uint8Array":e=T(e);break;case"Object":e=JSON.stringify(e);break;default:e=String(e),t="String"}return s.payload=e,s}function D(e){const t=[];return e.forEach((e=>{t.push({id:e.id,type:e.type,data:P(e.payload,e.type,p.get(e.meta,"preview")),meta:p.omit(e.meta,["preview"])})})),t}function B({payload:e,type:t}={}){if(t)switch(t){case"Uint8Array":return new Uint8Array(y(e,"Uint8Array"));case"Object":return JSON.parse(e);default:return String(e)}}function W(e,t){const s=new Map;return p.isEmpty(t)||t.forEach((t=>{let a="";try{a=B(t.data)}catch(e){pm.logger.error("WebSocketRequestHelper~deserializeMessages",e)}const n=t.id;s.set(n,{id:n,type:t.type,meta:p.assign(t.meta,{preview:t.data.preview||O(t.type,{message:a,mimeType:t.meta.mimeType,url:e})}),payload:a})})),s}function L(e){var t;const s={timestamp:e.meta.time,payload:{}};return s.payload={data:P(e.payload),...e.meta.mimeType?{mimeType:e.meta.mimeType}:{},size:(null===(t=e.meta)||void 0===t?void 0:t.size)||0,...e.meta.fileExtension?{fileExtension:e.meta.fileExtension}:{},...e.meta.eventName?{eventName:e.meta.eventName}:{}},s}function x(e,{url:t},s){try{const a=B(e.payload.data),n=O(s,{message:a,url:t,mimeType:e.payload.mimeType});return{type:s,meta:{time:e.timestamp,mimeType:e.payload.mimeType,size:e.payload.size,eventName:e.payload.eventName,fileExtension:e.payload.fileExtension,preview:n},payload:a}}catch(e){pm.logger.error("WebSocketRequestHelper~parseSentOrReceviedMessageEvent~deserializeMessages",e)}}},7438:function(e,t,s){s.r(t),s.d(t,{RawComposeMessage:function(){return r},SocketIOComposeMessage:function(){return l},WebSocketComposeMessage:function(){return o}});var a=s(9),n=s.n(a),i=s(4947);class o{constructor({content:e="",type:t=i.WebSocketMessageBodyType.TEXT,subtype:s=null}={}){this.content=String(e),this.type=String(t),this.subtype=null===s?s:String(s)}}class r extends o{constructor({id:e=n()(),title:t="New message",...s}={}){super(s),this.id=String(e),this.title=String(t)}}class l{constructor({id:e=n()(),title:t="New message",eventName:s="",acknowledgement:a=!1,args:i=[]}={}){this.id=String(e),this.title=String(t),this.eventName=String(s),this.acknowledgement=Boolean(a),this.args=Array.from(i).map((e=>new o(e))),this.args.length||this.args.push(new o)}}},7436:function(e,t,s){s.r(t),s.d(t,{BaseEventParser:function(){return p},BaseMessageParser:function(){return m},EVENT_TO_MESSAGE_TYPE_MAP:function(){return l},MESSAGE_TO_EVENT_TYPE_MAP:function(){return r}});var a=s(4994),n=s(4946),i=s(4992),o=s(12);const r={[n.WEBSOCKET_CONNECTED_MESSAGE]:"connected",[n.WEBSOCKET_DISCONNECTED_MESSAGE]:"disconnected",[n.WEBSOCKET_ERROR_MESSAGE]:"error",[n.WEBSOCKET_RECONNECTING_MESSAGE]:"reconnecting",[n.WEBSOCKET_ABORT_MESSAGE]:"aborted",[n.WEBSOCKET_OUTGOING_MESSAGE]:"sent-message",[n.WEBSOCKET_INCOMING_MESSAGE]:"received-message"},l=o.reduce(r,((e,t,s)=>(e[t]=s,e)),{}),c=e=>Object.entries(e).map((([e,t])=>({key:e,value:t}))),d=e=>null==e?void 0:e.reduce(((e,{key:t,value:s})=>({...e,[t]:s})),{}),u=e=>{const{handshakeRequest:t,handshakeResponse:s}=e,a=null==t?void 0:t.url,n=null==t?void 0:t.method,i=null==s?void 0:s.statusCode,o=null==s?void 0:s.statusMessage,r=d(null==t?void 0:t.headers),l=d(null==s?void 0:s.headers);if(a||n||i||r||l)return{"Request URL":a,"Request Method":n,...i?{"Status Code":`${i} ${o}`}:{},...r?{"Request Headers":r}:{},...l?{"Response Headers":l}:{}}},h=e=>{var t;const s=null==e||null===(t=e.payload)||void 0===t?void 0:t.handshakeDetails;let a="",n=null;if(null!=s&&s["Status Code"]){const e=s["Status Code"].split(" ");n=parseInt(e[0],10),a=e.slice(1).join(" ")}return{...s?{handshakeRequest:{method:s["Request Method"],headers:c(s["Request Headers"]),url:s["Request URL"]},...n&&s["Response Headers"]?{handshakeResponse:{statusCode:n,statusMessage:a,headers:c(s["Response Headers"])}}:{}}:{}}},p={connected:(e,t)=>{const s=l[e.type];return{type:s,meta:{time:e.timestamp,mimeType:"application/json",preview:(0,i.getMessagePreview)(s,{url:t})},payload:{handshakeDetails:u(e.payload)}}},disconnected:(e,t)=>{const s=l[e.type];return{type:s,meta:{time:e.timestamp,mimeType:"text/plain",preview:(0,i.getMessagePreview)(s,{url:t})},payload:{code:e.payload.code,name:e.payload.reason,description:(o=e.payload,o.code?(null===(c=n.WEBSOCKET_CONNECTION_CLOSE_CODES[o.code])||void 0===c?void 0:c.description)||n.WEBSOCKET_CONNECTION_CLOSE_CODES.unknown(o.code,"Error"!==o.reason?o.reason:"").description:o.reason&&(null===(r=a.SOCKETIO_CONNECTION_CLOSE_CODES[o.reason.toLowerCase()])||void 0===r?void 0:r.description)||a.SOCKETIO_CONNECTION_CLOSE_CODES.unknown(o.reason).description||"")}};var o,r,c},error:(e,t)=>{const s=l[e.type];return{type:s,meta:{time:e.timestamp,mimeType:"application/json",preview:(0,i.getMessagePreview)(s,{url:t})},payload:{error:e.payload.error.message,handshakeDetails:u(e.payload)}}},reconnecting:(e,t)=>{const s=l[e.type];return{type:s,meta:{time:e.timestamp,mimeType:"text/plain",preview:(0,i.getMessagePreview)(s,{url:t})}}},aborted:(e,t)=>{const s=l[e.type];return{type:s,meta:{time:e.timestamp,mimeType:"text/plain",preview:(0,i.getMessagePreview)(s,{url:t})}}}},m={[n.WEBSOCKET_CONNECTED_MESSAGE]:e=>{const t={type:r[e.type],timestamp:e.meta.time,payload:{}};return t.payload=h(e),t},[n.WEBSOCKET_DISCONNECTED_MESSAGE]:(e,t)=>{var s;const a={type:r[e.type],timestamp:e.meta.time,payload:{}},i=e.payload||{};return a.payload={...i.code?{code:i.code}:{},reason:i.name},1e3===i.code?t.result="success":[1002,1003,1005,1006,1007,1008,1009,1010].includes(i.code)?t.result="client-error":[1001,1011,1012,1013,1014,1015].includes(i.code)&&(t.result="server-error"),t.summary=(null===(s=n.WEBSOCKET_CONNECTION_CLOSE_CODES[i.code])||void 0===s?void 0:s.name)||"Error",a},[n.WEBSOCKET_ERROR_MESSAGE]:(e,t)=>{var s;const a={type:r[e.type],timestamp:e.meta.time,payload:{}},n=null==e||null===(s=e.payload)||void 0===s?void 0:s.error;return a.payload={...n?{error:{message:n}}:{},...h(e)},n&&(t.result="client-error",t.summary=n),a},[n.WEBSOCKET_RECONNECTING_MESSAGE]:e=>({type:r[e.type],timestamp:e.meta.time,payload:{}}),[n.WEBSOCKET_ABORT_MESSAGE]:(e,t)=>{const s={type:r[e.type],timestamp:e.meta.time,payload:{}};return t.summary="aborted",s}}},7434:function(e,t,s){s.r(t),s.d(t,{default:function(){return y}});var a,n=s(1006),i=s(4155),o=s(4160),r=s(4159),l=s(7435),c=s(7437),d=s(7439),u=s(4946),h=s(4984),p=s(1821),m=s(12),E=0;function g(e){return"__private_"+E+++"_"+e}var S=g("model"),_=g("status");class y extends r.default{constructor(...e){super(...e),this.id=null,Object.defineProperty(this,S,{writable:!0,value:void(0,p.i)(this,"model")}),this._models=new Map([]),Object.defineProperty(this,_,{writable:!0,value:void(0,p.i)(this,"status")})}setWorkbenchStatus(e){this.status=e,e!==i.READY&&e!==i.ERROR||this.setLoading(!1)}setActiveModel(e,...t){if(e!==m.get(this.model,"type")){if(this._models.has(e))return this.model=this._models.get(e),void this.attachTrackedState();switch(m.isEmpty(t)&&(t=[{id:this.id||this.wsHistoryId},u.WEBSOCKET_MESSAGE_STREAM_STATUS.Empty,{tabId:this.getTabId()}]),e){case u.WEBSOCKET_REQUEST_TYPE.RAW:this._models.set(u.WEBSOCKET_REQUEST_TYPE.RAW,new d.default(...t));break;case u.WEBSOCKET_REQUEST_TYPE.SOCKETIO:this._models.set(u.WEBSOCKET_REQUEST_TYPE.SOCKETIO,new c.default(...t));break;default:this._models.set("default",new l.default(...t))}this.model=this._models.get(e),this.setConflictOptions({entityType:"WebSocket request"}),this.attachTrackedState(),this.nameReactionDisposer=(0,n.reaction)((()=>this.model.name),(e=>this.setTitle(e)),{fireImmediately:!0})}}setConflictStatus(){this.setStatus("Conflict","This WebSocket request has been modified since you last opened the tab.")}attachTrackedState(){return this.model?this.model._trackedRequest?"function"!=typeof this.model.save?pm.logger.error("BaseWebSocketWorkbenchController~attachTrackedState: save is not a function"):(super.detachTrackedState(),void super.attachTrackedState(this.model._trackedRequest,this.model.save.bind(this.model),{persist:!0})):pm.logger.error("BaseWebSocketWorkbenchController~attachTrackedState: _trackedRequest not found"):pm.logger.error("BaseWebSocketWorkbenchController~attachTrackedState: model not found")}restoreRequestState(){if(!this.model)return;const e=this.getPersistedTrackedState();if(!e||!e.isDirty){var t;const e=(0,h.getData)(null===(t=this.model)||void 0===t?void 0:t.type,this.getTabId());return m.isEmpty(e)?void 0:this.model._trackedRequest.set(e)}this.model._trackedRequest.set((0,n.toJS)(e.updates)),(0,o.detectConflict)(this.model.initialState,e.initialState,this.model.isDirty,(t=>{t&&(this.model._trackedRequest.setInitialState((0,n.toJS)(e.initialState)),this.setConflictStatus())}))}didCreate(){}beforeDestroy(){this._models.forEach((e=>{e.nameReactionDisposer&&e.nameReactionDisposer(),e.dispose&&e.dispose()})),this.model&&this.model.disconnect(!0),this._models=null}}a=y,(0,p.g)(a.prototype,"model",[n.observable],(function(){return null})),(0,p.g)(a.prototype,"status",[n.observable],(function(){return i.LOADING})),(0,p.n)(a.prototype,"setWorkbenchStatus",[n.action]),(0,p.n)(a.prototype,"setActiveModel",[n.action])},7435:function(e,t,s){s.r(t),s.d(t,{default:function(){return se}});var a,n=s(9),i=s.n(n),o=s(4618),r=s(4877),l=s.n(r),c=s(1006),d=s(1826),u=s(4570),h=s(3916),p=s(5817),m=s(1934),E=s(1703),g=s(1935),S=s(4580),_=s(4564),y=s(4579),T=s(4578),f=s(3712),v=s(1799),b=s(5055),C=s(3952),M=s(4984),O=s(4946),A=s(7436),N=s(1821),I=s(12),w=0;function k(e){return"__private_"+w+++"_"+e}function R(e){return e?I.map([...e.values()],(e=>e.id)):[]}var P=k("title"),D=k("collection"),B=k("messageMap"),W=k("status"),L=k("badgeStatus"),x=k("connectionStatistics"),G=k("activeConnectionTab"),U=k("messageTypeFilter"),K=k("messageFilter"),H=k("expandedMessageSet"),F=k("selectedMessageSet"),q=k("firstVisibleMessageIndex"),Y=k("context"),z=k("messageMediaFilePaths"),V=k("messageStreamNotificationType"),Q=k("messageStreamStatus"),J=k("messages"),$=k("newMessages"),j=k("savedMessages"),X=k("draftComposeMessage"),Z=k("currentComposeMessage"),ee=k("editTitle"),te=k("savedMessagesStatus");class se{constructor(e,t,s=O.WEBSOCKET_MESSAGE_STREAM_STATUS.Empty,a={}){if(this.id=null,this.type="default",this.requestInfo={},Object.defineProperty(this,P,{writable:!0,value:void(0,N.i)(this,"title")}),Object.defineProperty(this,D,{writable:!0,value:void(0,N.i)(this,"collection")}),Object.defineProperty(this,B,{writable:!0,value:void(0,N.i)(this,"messageMap")}),this.connectionId=null,this.connectionHistoryId=null,this.handshakeConfiguration=null,this.handshakeError=!1,Object.defineProperty(this,W,{writable:!0,value:void(0,N.i)(this,"status")}),Object.defineProperty(this,L,{writable:!0,value:void(0,N.i)(this,"badgeStatus")}),Object.defineProperty(this,x,{writable:!0,value:void(0,N.i)(this,"connectionStatistics")}),Object.defineProperty(this,G,{writable:!0,value:void(0,N.i)(this,"activeConnectionTab")}),Object.defineProperty(this,U,{writable:!0,value:void(0,N.i)(this,"messageTypeFilter")}),Object.defineProperty(this,K,{writable:!0,value:void(0,N.i)(this,"messageFilter")}),Object.defineProperty(this,H,{writable:!0,value:void(0,N.i)(this,"expandedMessageSet")}),Object.defineProperty(this,F,{writable:!0,value:void(0,N.i)(this,"selectedMessageSet")}),Object.defineProperty(this,q,{writable:!0,value:void(0,N.i)(this,"firstVisibleMessageIndex")}),Object.defineProperty(this,Y,{writable:!0,value:void(0,N.i)(this,"context")}),Object.defineProperty(this,z,{writable:!0,value:void(0,N.i)(this,"messageMediaFilePaths")}),Object.defineProperty(this,V,{writable:!0,value:void(0,N.i)(this,"messageStreamNotificationType")}),Object.defineProperty(this,Q,{writable:!0,value:void(0,N.i)(this,"messageStreamStatus")}),this.historyEventToMessageType=A.EVENT_TO_MESSAGE_TYPE_MAP,this.messageToHistoryEventType=A.MESSAGE_TO_EVENT_TYPE_MAP,this.messageParser=A.BaseMessageParser,this.historyEventParser=A.BaseEventParser,Object.defineProperty(this,J,{writable:!0,value:void(0,N.i)(this,"messages")}),Object.defineProperty(this,$,{writable:!0,value:void(0,N.i)(this,"newMessages")}),this.scrollOffset=0,this._messageBuffer=[],Object.defineProperty(this,j,{writable:!0,value:void(0,N.i)(this,"savedMessages")}),Object.defineProperty(this,X,{writable:!0,value:void(0,N.i)(this,"draftComposeMessage")}),Object.defineProperty(this,Z,{writable:!0,value:void(0,N.i)(this,"currentComposeMessage")}),Object.defineProperty(this,ee,{writable:!0,value:void(0,N.i)(this,"editTitle")}),Object.defineProperty(this,te,{writable:!0,value:void(0,N.i)(this,"savedMessagesStatus")}),this.pendingPromiseMap={},!t)throw new Error(`${this.constructor.name}~constructor: request was not found`);this.id=t.id,this.type=e||t.type||this.type,this.title=t.title,this.collection=t.collection,this.requestInfo={createdAt:t.createdAt},this.set("context",a),this._trackedRequest=new C.ObservableTrackedState(this.getRequestForView(t)),this.set("messageMap",t.messageMap||c.observable.map()),this.set("messages",R(t.messageMap)),this.set("messageStreamStatus",s),this.draftComposeMessage=new C.ObservableTrackedState(new this.constructor.MessageClass),this.currentComposeMessage=this.draftComposeMessage,I.get(a,"isHistory")&&this.set("badgeStatus",O.IDLE),this.requestSDK=O.SDK_MAP[this.type],this.messageSDK=O.SDK_MAP[O.REQUEST_TYPE_TO_MESSAGE_TYPE_MAP[this.type]],this.fetchSavedMessage(),this.attachConnectionEventsListener(),this.agentConnectionAutorunDisposer=(0,c.autorun)((()=>{const{type:e,state:t}=pm.runtime.agent.stat;!this.connectionId||e===E.TYPES.WS&&t===E.STATES.CONNECTED||this.disconnect(!0)})),this.connectionStatusReactionDisposer=(0,c.reaction)((()=>this.status),(e=>{if(e===O.CONNECTED||e===O.IDLE)return this.showIntermediateStatusTimeout&&clearTimeout(this.showIntermediateStatusTimeout),void this.set("badgeStatus",e);this.showIntermediateStatusTimeout&&clearTimeout(this.showIntermediateStatusTimeout),this.showIntermediateStatusTimeout=setTimeout((()=>this.set("badgeStatus",e)),100)})),(0,c.reaction)((()=>this.hasUnsavedMessages),(e=>{this.set("_hasUnsavedMessages",e)}),{fireImmediately:!0}),(0,c.reaction)((()=>this.hasUnsavedDraft),(e=>{this.set("_hasUnsavedDraft",e)}),{fireImmediately:!0})}set(e,t){this[e]=t}set message(e){const t=e.id;this.messageMap.set(t,e),this._messageBuffer.push(t),this._interval||(this._interval=setTimeout((0,c.action)((()=>{0===this.scrollOffset?this.messages.push(...this._messageBuffer):this.newMessages.push(...this._messageBuffer),this._interval=null,this._messageBuffer=[]})),100))}get isDirty(){return this._trackedRequest.isDirty}get initialState(){return this._trackedRequest.initialState}get updates(){return this._trackedRequest.updates}set url(e){this._trackedRequest.set({url:e})}get url(){return this._trackedRequest.get("url")}set headers(e){this._trackedRequest.set({headers:e})}get headers(){return this._trackedRequest.get("headers")}set queryParams(e){this._trackedRequest.set({queryParams:e})}get queryParams(){return this._trackedRequest.get("queryParams")}set settings(e){this._trackedRequest.set({settings:e})}get settings(){return this._trackedRequest.get("settings")}set _hasUnsavedMessages(e){this._trackedRequest.set({_hasUnsavedMessages:e})}set _hasUnsavedDraft(e){this._trackedRequest.set({_hasUnsavedDraft:e})}get hasMultipleSavedMessages(){var e;return(null===(e=S.default.cacheAPI.get(this.id))||void 0===e||null===(e=e.children)||void 0===e||null===(e=e.filter((e=>e.type===O.REQUEST_TYPE_TO_MESSAGE_TYPE_MAP[this.type])))||void 0===e?void 0:e.length)>1}get layoutName(){return(0,h.resolveStoreInstance)(p.default).get("editor.requestEditorLayoutName")}get extensions(){return this._trackedRequest.get("extensions")}resetTracking(){const e=I.reduce(this.constructor.editableAttributes,((e,t,s)=>(I.has(this,s)?e[s]=this[s]:e[s]=t.defaultsTo,e)),{});e._hasUnsavedMessages=!1,e._hasUnsavedDraft=!1,this._trackedRequest.reset(e)}get visibleMessages(){const e=I.slice(this.messages,this.firstVisibleMessageIndex);return I.map(e,(e=>this.messageMap.get(e)))}get filteredMessagesByType(){if(this.messageTypeFilter===O.WEBSOCKET_ALL_MESSAGES)return this.visibleMessages;return new o.default(this.visibleMessages,this.constructor.keysForFilterByType).search(this.messageTypeFilter)}get filteredMessages(){if(!this.messageFilter)return this.filteredMessagesByType;return new o.default(this.filteredMessagesByType,this.constructor.keysForFilterByKeyword).search(this.messageFilter)}get visibleItems(){return!this.isFilterApplied&&this.hasMessagesToRestore?[{type:O.WEBSOCKET_HIDDEN_MESSAGE},...this.filteredMessages]:this.filteredMessages}get hasMessagesToRestore(){return 0!==this.firstVisibleMessageIndex}get isFilterApplied(){return this.messageFilter||this.messageTypeFilter!==O.WEBSOCKET_ALL_MESSAGES}flushNewMessages(){this.messages=I.concat(this.messages,this.newMessages),this.newMessages.clear()}hideAllMessages(){this.firstVisibleMessageIndex+=this.visibleMessages.length}clearAllMessages(){(0,c.transaction)((()=>{this.firstVisibleMessageIndex=0,this.messageMap.clear(),this.messages.clear(),this.newMessages.clear()}))}restoreHiddenMessages(){this.firstVisibleMessageIndex=0}toggleExpanded(e,t){return this.expandedMessageSet.has(e)?I.isNil(t)?this.expandedMessageSet.delete(e):void this.expandedMessageSet.set(e,t):this.expandedMessageSet.set(e,{})}toggleMessageSelect(e){this.selectedMessageSet.has(e)?this.selectedMessageSet.delete(e):this.selectedMessageSet.set(e,!0)}deselectAllMessages(){this.selectedMessageSet.clear()}saveMediaFilePath(e,t){e&&this.messageMediaFilePaths.set(e,t)}get timeDifference(){const e=[...this.selectedMessageSet.keys()],t=I.get(this.messageMap.get(e[0]),"meta.time"),s=I.get(this.messageMap.get(e[1]),"meta.time");return t&&s?l()(Math.abs(new Date(t).getTime()-new Date(s).getTime())):"Not available"}async createNewMessage(e){const t=new C.ObservableTrackedState(new this.constructor.MessageClass(e));await this.saveMessage(t,!0)}async saveMessage(e,t=!1){const s={...(0,c.toJS)(e.initialState),...(0,c.toJS)(e.updates)};if(void 0!==s.eventName&&(""===s.eventName&&(s.eventName="message"),this.eventsCache.getColor(s.eventName)),!t){if(!this.messageSDK.isOnline(!0)||!this.messageSDK.hasPermission(s.id,_.ItemAction.SAVE,!0))throw new Error(`${this.constructor.saveMessage}~saveMessage: Cannot execute this action.`);try{return await this.messageSDK.update(this._serializeSavedMessage(s)),void e.reset(s)}catch(e){throw pm.logger.error(`${this.constructor.name}~saveMessage: Error in updating message`,e),pm.toasts.error("Something went wrong while saving the message.",{dedupeId:"ws-message-save"}),e}}if(!this.messageSDK.isOnline(!0)||!this.messageSDK.hasPermission(null,_.ItemAction.CREATE,!0,this.id))throw new Error(`${this.constructor.saveMessage}~saveMessage: Cannot execute this action.`);try{this._selfMessageCreate=!0,await this.messageSDK.create(this.id,this._serializeSavedMessage(I.omit(s,"id"))),e.resetUpdates()}catch(e){throw pm.logger.error(`${this.constructor.name}~saveAsMessage: Error in creating message`,e),pm.toasts.error("Something went wrong while saving the message.",{dedupeId:"ws-message-create"}),e}}async deleteSavedMessage(e){if(this.draftComposeMessage===e)return e.resetUpdates();this.messageSDK.isOnline(!0)&&this.messageSDK.hasPermission(e.get("id"),_.ItemAction.DELETE,!0)&&pm.mediator.trigger("showDeleteWebSocketMessageModal",e.get("title"),(async()=>{try{await this.messageSDK.delete(e.get("id"));const t=this.savedMessages.indexOf(e);-1!==t&&(0,c.runInAction)((()=>this.savedMessages.splice(t,1))),this.currentComposeMessage===e&&(0,c.runInAction)((()=>{this.currentComposeMessage=this.draftComposeMessage}))}catch(e){pm.logger.error(`${this.constructor.name}~deleteSavedMessage: Error in deleting message`,e),pm.toasts.error("Something went wrong while deleting the message.",{dedupeId:"ws-message-delete"})}}))}async duplicateSavedMessage(e){const t=I.omit((0,c.toJS)(e.initialState),"id");if(this.messageSDK.isOnline(!0)&&this.messageSDK.hasPermission(e.get("id"),_.ItemAction.DUPLICATE,!0))try{this._selfMessageCreate=!0,await this.messageSDK.create(this.id,this._serializeSavedMessage(t))}catch(e){pm.logger.error(`${this.constructor.name}~duplicateSavedMessage: Error in creating message`,e),pm.toasts.error("Something went wrong while duplicating the message.",{dedupeId:"ws-message-dup"})}}revertSavedMessage(e){e.resetUpdates()}selectSavedMessage(e){this.currentComposeMessage=e}async saveMessageProperty(e,t,s){const a={...(0,c.toJS)(e.initialState),[t]:s};if(e.get("id")===this.draftComposeMessage.get("id"))return e.set({[t]:s});if(this.messageSDK.isOnline(!0)&&this.messageSDK.hasPermission(a.id,_.ItemAction.SAVE,!0))try{await this.messageSDK.update(this._serializeSavedMessage(a)),e.set({[t]:s}),e.setInitialState(a)}catch(e){pm.logger.error(`${this.constructor.name}~saveMessageProperty: Error in updating message property.`,e),pm.toasts.error("Something went wrong while updating the message.",{dedupeId:"ws-message-save"})}}toggleSavedMessagePane(e){this.savedMessagesPaneRef&&this.savedMessagesPaneRef.handleCollapseToggle("x",e)}_serializeSavedMessage(){throw new Error(`${this.constructor.name}~_serializeSavedMessage: not implemented`)}_deserializeSavedMessage(){throw new Error(`${this.constructor.name}~_deserializeSavedMessage: not implemented`)}async fetchSavedMessage(){const{children:e}=S.default.cacheAPI.get(this.id)||{};if(this.isSavedRequest&&!this.messagesChangeListenersDisposer&&(this.messagesChangeListenersDisposer=S.default.cacheAPI.subscribeToChanges({onCreate:e=>this.handleIncomingMessages("onCreate",e),onUpdate:e=>this.handleIncomingMessages("onUpdate",e),onDelete:e=>this.handleIncomingMessages("onDelete",e)},{parent:this.id,type:O.REQUEST_TYPE_TO_MESSAGE_TYPE_MAP[this.type]})),this.isSavedRequest&&!I.isEmpty(e)){this.set("savedMessagesStatus",O.WEBSOCKET_MESSAGE_STREAM_STATUS.Loading);try{const e=[O.REQUEST_TYPE_TO_MESSAGE_TYPE_MAP[this.type]],t=await this.requestSDK.getAllChildrenObservable(this.id,e),{MessageClass:s}=this.constructor;(0,c.transaction)((()=>{(0,c.runInAction)((()=>this.savedMessages.push(...(t||[]).map((e=>new C.ObservableTrackedState(new s(this._deserializeSavedMessage(e)))))))),this.set("savedMessagesStatus",O.WEBSOCKET_MESSAGE_STREAM_STATUS.Ready)})),this.selectSavedMessage(this.savedMessages[0])}catch(e){this.set("savedMessagesStatus",O.WEBSOCKET_MESSAGE_STREAM_STATUS.Error),pm.logger.error(`${this.constructor.name}~didCreate: Error in loading messages`,e)}}else this.set("savedMessagesStatus",O.WEBSOCKET_MESSAGE_STREAM_STATUS.Ready)}handleIncomingMessages(e,t){const{MessageClass:s}=this.constructor;switch(e){case"onCreate":return void this.messageSDK.getObservable(t.id).then((e=>{const t=new C.ObservableTrackedState(new s(this._deserializeSavedMessage(e)));(0,c.runInAction)((()=>{this.savedMessages.push(t),this._selfMessageCreate&&(this.currentComposeMessage=t,this._selfMessageCreate=!1,this.savedMessages.length>1&&(this.editTitle=t.get("id"),this.toggleSavedMessagePane(!1)))}))})).catch((e=>pm.logger.error(`${this.constructor.name}~handleIncomingMessages: Error in fetching new message`,e)));case"onUpdate":{const e=I.find(this.savedMessages,(e=>e.get("id")===t.id));return void(e&&e.setInitialState(new s(this._deserializeSavedMessage(t))))}case"onDelete":{const e=I.findIndex(this.savedMessages,(e=>e.get("id")===t.id));if(-1===e)return;return this.currentComposeMessage===this.savedMessages[e]&&(this.currentComposeMessage=this.draftComposeMessage),this.savedMessages.splice(e,1)}}}get name(){return this.title||this.url||"Untitled Request"}get breadcrumbPath(){const e=S.default.cacheAPI.get(this.id);if(!e)return;const t=[];let s=e;for(;s;)t.push({id:s.id,type:s.type,name:s.title}),s=s.parent&&(S.default.cacheAPI.get(s.parent)||y.default.cacheAPI.get(s.parent));return I.reverse(t)}get connectionConfigEditDisabled(){return this.status===O.CONNECTING||this.status===O.RECONNECTING||this.status===O.CONNECTED}get isSavedRequest(){return Boolean(this.collection)}get hasUnsavedMessages(){return I.some(this.savedMessages,"isDirty")}get hasUnsavedDraft(){return I.isEmpty(this.savedMessages)&&this.currentComposeMessage.isDirty}get actions(){return[{type:_.ItemAction.DELETE,label:"Delete",shortcut:"delete",isEnabled:this.requestSDK.isOnline()&&this.requestSDK.hasPermission(this.id,_.ItemAction.DELETE)}]}unsetContext(e){this.context&&delete this.context[e]}connectionSetup(){this.connectionId=i()(),this.handshakeError=!1,(0,c.transaction)((()=>{this.clearAllMessages(),this.deselectAllMessages(),this.set("connectionStatistics",{}),this.expandedMessageSet.clear(),this.messageMediaFilePaths.clear(),this.set("messageStreamStatus",O.WEBSOCKET_MESSAGE_STREAM_STATUS.Ready)}))}connectionCleanup(){this.connectionId=null,this.connectionHistoryId=null,this.handshakeConfiguration=null}getRequestForView(e){const t=I.get(e,"payload",{}),s=I.reduce(this.constructor.editableAttributes,((e,s,a)=>(I.has(t,a)?e[a]=t[a]:e[a]=s.defaultsTo,e)),{});return s.headers=(0,f.mapDisableToEnable)(s.headers),s.queryParams=(0,f.mapDisableToEnable)(s.queryParams),s.extensions=I.get(e,"extensions",{documentation:{content:""}}),s._hasUnsavedMessages=!1,s._hasUnsavedDraft=!1,s}getRequestForStorage(){const e=(0,c.toJS)({id:this.id,type:this.type,title:this.title,payload:{url:this.url,headers:this.headers,queryParams:this.queryParams,settings:this.settings}},{recurseEverything:!0});return e.payload.headers=(0,f.mapEnableToDisable)(e.payload.headers),e.payload.queryParams=(0,f.mapEnableToDisable)(e.payload.queryParams),e}handleIncomingUpdates(e){e&&(0,c.transaction)((()=>{this.set("title",e.title),this._trackedRequest.setInitialState(this.getRequestForView(e))}))}cacheUpdatesBuffer(){(0,M.setData)(this.type,I.get(this.context,"tabId"),(0,c.toJS)(this._trackedRequest.updates))}attachConnectionEventsListener(){}requestWorkbenchSave(){g.default.requestSave({id:(0,h.resolveStoreInstance)(m.default).activeEditor})}saveAs(){if(v.default.isEnabled)return pm.mediator.trigger("showSignInModal",{type:"save",origin:"save_shortcut",subtitle:b.SAVE_REQUEST_SIGNIN_MODAL_SUBTITLE});if(!((0,h.resolveStoreInstance)(u.default).userCanSave&&(!I.isEmpty(y.default.getEditableCollections())||y.default.hasPermission(null,T.ECAction.CREATE,!0))))return;let e;if(this.hasUnsavedDraft){const t={...(0,c.toJS)(this.currentComposeMessage.initialState),...(0,c.toJS)(this.currentComposeMessage.updates)};e=this._serializeSavedMessage(I.omit(t,"id"))}pm.mediator.trigger("showAddItemToCollectionModal",I.omit(this.getRequestForStorage(),"id"),{tabId:I.get(this.context,"tabId")},(async t=>{e&&await this.messageSDK.create(t,e)}))}save({saveAs:e}){if(!this.id)return pm.logger.error(`${this.constructor.name}~save: Request id not found`),Promise.reject(new Error("Request id not found"));if(e||!this.isSavedRequest)return this.saveAs(),Promise.resolve();if(!((this.isDirty||!this.isSavedRequest)&&this.requestSDK.isOnline(!0)&&this.requestSDK.hasPermission(this.id,_.ItemAction.SAVE,!0)))return Promise.resolve();const t=[];return this.hasUnsavedMessages&&I.forEach(this.savedMessages,(e=>{e.isDirty&&t.push(this.saveMessage(e))})),this.hasUnsavedDraft&&t.push(this.saveMessage(this.currentComposeMessage,!0)),Promise.all([this.requestSDK.update(this.getRequestForStorage()).catch((e=>(pm.logger.error("Error while updating WebSocket request",e),pm.toasts.error("Something went wrong while saving the request.",{dedupeId:"ws-request-tab-save"}),Promise.reject(new Error("Error while updating request."))))),...t]).then((()=>this.resetTracking()))}_getHistoryMeta(){return{url:(0,c.toJS)(this.url),headers:(0,c.toJS)(this.headers),queryParams:(0,c.toJS)(this.queryParams),settings:(0,c.toJS)(this.settings),subprotocol:O.WEBSOCKET_REQUEST_TYPE_TO_SUBPROTOCOL_MAP[this.type],createdAt:(new Date).toISOString()}}_getHistoryContext(){const e=this.getRequestForStorage();return{workspaceId:(0,h.resolveStoreInstance)(d.default).id,url:(0,c.toJS)(this.url),collectionId:this.collection,item:{...e,id:this.collection?this.id:null,title:this.title||"Untitled WebSocket Request",extensions:(0,c.toJS)(this.extensions)}}}_messagesToHistoryEvents(){const e=[],t={result:"success",summary:"Normal Closure"};return this.messageMap.forEach((s=>{const a=this.messageToHistoryEventType[s.type];a&&e.push({type:a,...this.messageParser[s.type](s,t)})})),e.push(t),e}_historyEventsToMessages(e){const t=new Map,s=this.getRequestForStorage();return I.forEach(e,(e=>{const a=i()(),n=this.historyEventToMessageType[e.type];n&&t.set(a,{id:a,...this.historyEventParser[e.type](e,s.payload.url,n)})})),t}_serializeMessages(e){return[]}_deserializeMessages(e){return new Map}onMessageStreamFetch(e,t){if(e)return this.set("messageStreamStatus",O.WEBSOCKET_MESSAGE_STREAM_STATUS.Error);if(t.find((e=>void 0===e.payload)))return this.set("messageStreamStatus",O.WEBSOCKET_MESSAGE_STREAM_STATUS.Truncated);const s=this._historyEventsToMessages(t);this.set("messageMap",s),this.set("messages",R(this.messageMap)),0===I.size(this.messageMap)?this.set("messageStreamStatus",O.WEBSOCKET_MESSAGE_STREAM_STATUS.Empty):this.set("messageStreamStatus",O.WEBSOCKET_MESSAGE_STREAM_STATUS.Ready)}createHistory(){const e=this._getHistoryContext(),t=this._messagesToHistoryEvents();O.SDK_MAP[this.type].history.createHistory([e,...t]).catch((e=>{pm.logger.error(`${this.constructor.name}~onEnd: Error while creating history`,e)}))}dispose(){this.agentConnectionAutorunDisposer&&this.agentConnectionAutorunDisposer(),this.connectionStatusReactionDisposer&&this.connectionStatusReactionDisposer(),this.messagesChangeListenersDisposer&&this.messagesChangeListenersDisposer(),this.messagesChangeListenersDisposer=null}}a=se,se.editableAttributes={url:{defaultsTo:""},headers:{defaultsTo:[]},queryParams:{defaultsTo:[]},settings:{defaultsTo:{}}},(0,N.g)(a.prototype,"title",[c.observable]),(0,N.g)(a.prototype,"collection",[c.observable],(function(){return null})),(0,N.g)(a.prototype,"messageMap",[c.observable],(function(){return c.observable.map()})),(0,N.g)(a.prototype,"status",[c.observable],(function(){return O.IDLE})),(0,N.g)(a.prototype,"badgeStatus",[c.observable],(function(){return null})),(0,N.g)(a.prototype,"connectionStatistics",[c.observable],(function(){return{}})),(0,N.g)(a.prototype,"activeConnectionTab",[c.observable],(function(){return O.WEBSOCKET_MESSAGES})),(0,N.g)(a.prototype,"messageTypeFilter",[c.observable],(function(){return O.WEBSOCKET_ALL_MESSAGES})),(0,N.g)(a.prototype,"messageFilter",[c.observable],(function(){return""})),(0,N.g)(a.prototype,"expandedMessageSet",[c.observable],(function(){return c.observable.map()})),(0,N.g)(a.prototype,"selectedMessageSet",[c.observable],(function(){return c.observable.map()})),(0,N.g)(a.prototype,"firstVisibleMessageIndex",[c.observable],(function(){return 0})),(0,N.g)(a.prototype,"context",[c.observable],(function(){return null})),(0,N.g)(a.prototype,"messageMediaFilePaths",[c.observable],(function(){return c.observable.map()})),(0,N.g)(a.prototype,"messageStreamNotificationType",[c.observable],(function(){return null})),(0,N.g)(a.prototype,"messageStreamStatus",[c.observable]),(0,N.g)(a.prototype,"messages",[c.observable],(function(){return c.observable.array()})),(0,N.g)(a.prototype,"newMessages",[c.observable],(function(){return c.observable.array()})),(0,N.g)(a.prototype,"savedMessages",[c.observable],(function(){return c.observable.array()})),(0,N.g)(a.prototype,"draftComposeMessage",[c.observable],(function(){return null})),(0,N.g)(a.prototype,"currentComposeMessage",[c.observable],(function(){return null})),(0,N.g)(a.prototype,"editTitle",[c.observable],(function(){return null})),(0,N.g)(a.prototype,"savedMessagesStatus",[c.observable]),(0,N.n)(a.prototype,"set",[c.action]),(0,N.n)(a.prototype,"isDirty",[c.computed]),(0,N.n)(a.prototype,"initialState",[c.computed]),(0,N.n)(a.prototype,"updates",[c.computed]),(0,N.n)(a.prototype,"url",[c.computed]),(0,N.n)(a.prototype,"headers",[c.computed]),(0,N.n)(a.prototype,"queryParams",[c.computed]),(0,N.n)(a.prototype,"settings",[c.computed]),(0,N.n)(a.prototype,"hasMultipleSavedMessages",[c.computed]),(0,N.n)(a.prototype,"layoutName",[c.computed]),(0,N.n)(a.prototype,"extensions",[c.computed]),(0,N.n)(a.prototype,"visibleMessages",[c.computed]),(0,N.n)(a.prototype,"filteredMessagesByType",[c.computed]),(0,N.n)(a.prototype,"filteredMessages",[c.computed]),(0,N.n)(a.prototype,"visibleItems",[c.computed]),(0,N.n)(a.prototype,"hasMessagesToRestore",[c.computed]),(0,N.n)(a.prototype,"isFilterApplied",[c.computed]),(0,N.n)(a.prototype,"flushNewMessages",[c.action]),(0,N.n)(a.prototype,"hideAllMessages",[c.action]),(0,N.n)(a.prototype,"clearAllMessages",[c.action]),(0,N.n)(a.prototype,"restoreHiddenMessages",[c.action]),(0,N.n)(a.prototype,"toggleExpanded",[c.action]),(0,N.n)(a.prototype,"toggleMessageSelect",[c.action]),(0,N.n)(a.prototype,"deselectAllMessages",[c.action]),(0,N.n)(a.prototype,"saveMediaFilePath",[c.action]),(0,N.n)(a.prototype,"timeDifference",[c.computed]),(0,N.n)(a.prototype,"createNewMessage",[c.action]),(0,N.n)(a.prototype,"selectSavedMessage",[c.action]),(0,N.n)(a.prototype,"handleIncomingMessages",[c.action]),(0,N.n)(a.prototype,"name",[c.computed]),(0,N.n)(a.prototype,"breadcrumbPath",[c.computed]),(0,N.n)(a.prototype,"connectionConfigEditDisabled",[c.computed]),(0,N.n)(a.prototype,"isSavedRequest",[c.computed]),(0,N.n)(a.prototype,"hasUnsavedMessages",[c.computed]),(0,N.n)(a.prototype,"hasUnsavedDraft",[c.computed]),(0,N.n)(a.prototype,"unsetContext",[c.action])},7433:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var a=s(4155),n=s(1827),i=s(4948),o=s(4989),r=s(7434),l=s(4946);class c extends r.default{didCreate({queryParams:e,additionalContext:t}){var s;const r=this._tabId;this.setWorkbenchStatus(a.LOADING);const c=null===(s=this.getRouteConfig())||void 0===s?void 0:s.routeIdentifier,d=null!=c&&c.includes("ws-socketio-request")?l.WEBSOCKET_REQUEST_TYPE.SOCKETIO:l.WEBSOCKET_REQUEST_TYPE.RAW;if(!e||!e.requestId||e.requestId!==r)return n.default.transitionTo(d===l.WEBSOCKET_REQUEST_TYPE.RAW?i.default.openNewIdentifier:o.default.openNewIdentifier,{},{requestId:r},{tabOptions:{openIn:this._tabId},replace:!0,additionalContext:t});this.id=r,this.setActiveModel(d,{id:this.id},l.WEBSOCKET_MESSAGE_STREAM_STATUS.Empty,{...t,tabId:this.getTabId()}),this.restoreRequestState(),this.setWorkbenchStatus(a.READY)}}},7400:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(4156),o=s(3050),r=s(4155),l=s(7401),c=s(4946),d=s(1821);const u=(0,d.c)(class extends a.Component{constructor(){super(),this.handleTypeSwitch=this.handleTypeSwitch.bind(this)}handleTypeSwitch(e){this.props.controller&&this.props.controller.setActiveModel(e)}render(){const{model:e,status:t}=this.props.controller,s=this.props.id;return t===c.WORKBENCH_VIEW_PERMISSION_ERROR?a.createElement(o.default,{userFriendlyEntityName:"WebSocket request",icon:"icon-entity-websocket-stroke",title:"You don't have view permission",message:"Only team members can view WebSocket requests from history of this workspace.",hasToCapitalize:!1}):t===c.WORKBENCH_UNSUPPORTED_SUBPROTOCOL_ERROR?a.createElement(o.default,{type:"error",title:"Unsupported WebSocket request type",message:"Please update your app to view this WebSocket request history.",userFriendlyEntityName:"WebSocket request",hasToCapitalize:!1}):t===r.ERROR?a.createElement(o.default,{type:"error",userFriendlyEntityName:"WebSocket request",hasToCapitalize:!1}):t===r.DELETED?a.createElement(o.default,{type:"deleted",userFriendlyEntityName:"WebSocket request",hasToCapitalize:!1}):t===r.READY?a.createElement(l.default,{model:e,editorId:s,switchType:this.handleTypeSwitch}):a.createElement(i.default,null)}},[n.observer]);t.default=u},7429:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(2126),o=s(1929),r=s(2111),l=s(2101),c=s(2802),d=s(2138),u=s(2370),h=s(4386),p=s(3786),m=s(7430),E=s(12);const g=(0,i.default)(l.PaneLabel).withConfig({displayName:"WebSocketComposeArea__StyledPaneLabel",componentId:"postman-app__sc-44lva5-0"})([".pane-label__arrow{margin-right:var(--spacing-s) !important;& i > svg > path{fill:var(--content-color-secondary) !important;}}"]),S=(0,i.default)(h.Button).withConfig({displayName:"WebSocketComposeArea__StyledButton",componentId:"postman-app__sc-44lva5-1"})(["padding:var(--spacing-zero) var(--spacing-xs);"]);t.default=(0,n.observer)((({children:e,model:t})=>{const s=a.useRef(null),n=a.useRef(null);function i(){s.current&&s.current.handleCollapseToggle("x")}function _(){n.current&&n.current.unCollapse("x")}return(0,a.useEffect)((()=>{t.hasMultipleSavedMessages&&s.current&&s.current.unCollapse("x")}),[]),(0,a.useEffect)((()=>{1===t.savedMessages.length&&t.savedMessages[0]&&t.savedMessages[0].get("id")!==t.currentComposeMessage.get("id")&&t.selectSavedMessage(t.savedMessages[0])}),[t.savedMessages.length]),(0,a.useEffect)((()=>{s.current&&(s.current.widths.max=t.layoutName===p.REQUESTER_TAB_LAYOUT_1_COLUMN?o.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_MAX_WIDTH:null)}),[t.layoutName]),t.isSavedRequest?a.createElement(l.PaneGroup,{defaultLayout:r.PANE_LAYOUT_HORIZONTAL},a.createElement(l.Pane,{width:{default:o.default.ui.WEBSOCKET_REQUEST_COMPOSE_PANE_DEFAULT_WIDTH,min:o.default.ui.WEBSOCKET_REQUEST_COMPOSE_PANE_MIN_WIDTH,collapsed:o.default.ui.WEBSOCKET_REQUEST_COMPOSE_PANE_COLLAPSED_WIDTH,uncollapsed:o.default.ui.WEBSOCKET_REQUEST_COMPOSE_PANE_UNCOLLAPSED_WIDTH},ref:e=>{n.current=e}},a.createElement(l.PaneHeader,{defaultLayout:r.PANE_LAYOUT_HORIZONTAL,verticalComponent:a.createElement(l.PaneLabel,{layout:r.PANE_LAYOUT_VERTICAL,label:a.createElement(c.default,{type:"body-medium",color:"content-color-secondary"},"Editor"),arrowDirection:"right",onClick:_})}),a.createElement(l.PaneContent,null,e)),a.createElement(l.Pane,{width:{default:o.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_DEFAULT_WIDTH,max:t.layoutName===p.REQUESTER_TAB_LAYOUT_1_COLUMN?o.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_MAX_WIDTH:null,min:o.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_MIN_WIDTH,collapsed:o.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_COLLAPSED_WIDTH,uncollapsed:o.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_UNCOLLAPSED_WIDTH,collapsedByDefault:!0},ref:e=>{s.current=e,t.savedMessagesPaneRef=e}},a.createElement(l.PaneHeader,{width:o.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_COLLAPSED_WIDTH,defaultLayout:r.PANE_LAYOUT_HORIZONTAL,horizontalComponent:a.createElement(g,{layout:r.PANE_LAYOUT_HORIZONTAL,label:a.createElement(h.Flex,{alignItems:"center",justifyContent:"space-between"},a.createElement("span",null,"Saved messages"),a.createElement(h.Flex,{alignItems:"center"},a.createElement(S,{icon:a.createElement(d.default,null),variant:"tertiary",onClick:function(){t.hasUnsavedDraft?t.saveMessage(t.currentComposeMessage,!0):t.createNewMessage().catch(E.noop)},size:"small",tooltip:"Add message"}),a.createElement("div",{onClick:i,className:"pane-label__arrow"},a.createElement(u.default,null))))}),verticalComponent:a.createElement(l.PaneLabel,{layout:r.PANE_LAYOUT_VERTICAL,label:a.createElement(h.Flex,{alignItems:"baseline",gap:"spacing-s"},a.createElement(c.default,{type:"body-medium",color:"content-color-secondary"},"Saved messages"),a.createElement(h.DirtyIndicator,{isDirty:!0===t.hasUnsavedMessages||null})),arrowDirection:"left",onClick:i})}),a.createElement(l.PaneContent,null,a.createElement(m.default,{model:t,unCollapseEditorPane:_})))):a.createElement(a.Fragment,null,e)}))},7419:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(7420),o=s(7421),r=s(7423),l=s(7424),c=s(7425),d=s(7426),u=s(7427),h=s(7428),p=s(7429),m=s(4946),E=s(1821);const g=(0,E.c)(class extends a.Component{render(){const{model:e,highlightEventsTab:t}=this.props;return a.createElement(d.default,{activeKey:e.activeConnectionTab},a.createElement(c.default,{key:m.WEBSOCKET_MESSAGES},a.createElement(p.default,{model:e},e.type===m.WEBSOCKET_REQUEST_TYPE.RAW?a.createElement(u.default,{model:e}):a.createElement(h.default,{model:e}))),a.createElement(c.default,{key:m.WEBSOCKET_CONNECTION_QUERY_PARAMS},a.createElement(l.default,{model:e})),a.createElement(c.default,{key:m.WEBSOCKET_CONNECTION_HEADERS},a.createElement(o.default,{model:e})),a.createElement(c.default,{key:m.WEBSOCKET_CONNECTION_SETTINGS},a.createElement(r.default,{model:e})),e.type===m.WEBSOCKET_REQUEST_TYPE.SOCKETIO&&a.createElement(c.default,{key:m.WEBSOCKET_CONNECTION_EVENTS},a.createElement(i.default,{model:e,highlight:t})))}},[n.observer]);t.default=g},7418:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(3884),o=s(2802),r=s(2372),l=s(2368),c=s(2364),d=s(3786),u=s(1929),h=s(4386),p=s(2126),m=s(3885),E=s(4946),g=s(1821),S=s(12);const _=p.default.div.withConfig({displayName:"WebSocketConnectionTabs__IconWrapper",componentId:"postman-app__sc-1mcodaw-0"})(["margin-right:var(--spacing-s);"]),y=(0,p.default)(o.default).withConfig({displayName:"WebSocketConnectionTabs__StyledText",componentId:"postman-app__sc-1mcodaw-1"})(["margin-left:var(--spacing-xs);line-height:var(--line-height-s);"]),T=(0,g.c)(class extends a.Component{constructor(e){super(e),this.handleTabSelect=this.handleTabSelect.bind(this)}getMeta(e){return e&&a.createElement("div",{className:"websocket-tabs-badge"})}getCount(e,t){return e&&a.createElement(y,{color:"content-color-success"},"(",t,")")}getTabsList(){const e=[];return e.push({refKey:E.WEBSOCKET_MESSAGES,label:"Message"}),this.props.model.type===E.WEBSOCKET_REQUEST_TYPE.SOCKETIO&&e.push({refKey:E.WEBSOCKET_CONNECTION_EVENTS,label:"Events ",getBadge:()=>this.getCount(!S.isEmpty(this.props.model.events),this.props.model.events.length)}),e.push({refKey:E.WEBSOCKET_CONNECTION_QUERY_PARAMS,label:"Params",getBadge:()=>this.getMeta(!S.isEmpty(this.props.model.queryParams))}),e.push({refKey:E.WEBSOCKET_CONNECTION_HEADERS,label:"Headers",getBadge:()=>this.getMeta(!S.isEmpty(this.props.model.headers))}),e.push({refKey:E.WEBSOCKET_CONNECTION_SETTINGS,label:"Settings",getBadge:()=>this.getMeta(!S.isEmpty(this.props.model.settings))}),e}handleTabSelect(e){this.props.model.set("activeConnectionTab",e),this.props.onSelect&&this.props.onSelect()}renderToggle(e,t){let s=e===d.REQUESTER_TAB_LAYOUT_1_COLUMN?r.default:l.default;return t&&e===d.REQUESTER_TAB_LAYOUT_1_COLUMN&&(s=c.default),a.createElement(s,{color:"content-color-tertiary"})}render(){const{isCollapsed:e,layout:t,model:s,connectionPaneWidth:n}=this.props,o=n()<u.default.ui.WEBSOCKET_REQUEST_TAB_THRESHOLD?m.DROPDOWN:m.HORIZONTAL_LIST;return a.createElement(h.Flex,{alignItems:"center"},a.createElement(i.default,{activeTab:s.activeConnectionTab,tabsList:this.getTabsList(),tabsListType:o,onTabSelect:this.handleTabSelect,isCollapsed:e}),a.createElement(_,{className:"websocket-message-pane-label__actions__arrow",onClick:this.props.onClick},this.renderToggle(t,e)))}},[n.observer]);t.default=T},7420:function(e,t,s){s.r(t);var a=s(1),n=s(2126),i=s(2098),o=s(4386),r=s(4946);const l=n.default.div.withConfig({displayName:"WebSocketEvents__HighlightBox",componentId:"postman-app__sc-2gj8hd-0"})(["position:relative;::before{content:'';display:block;position:absolute;top:0px;bottom:0px;left:0px;right:0px;pointer-events:none;background-color:transparent;transition:background-color 1.2s;","}"],(e=>e.highlight&&(0,n.css)(["background-color:var(--background-color-info);transition:background-color 0.1s;"]))),c=[{key:"name",label:"Events",placeholder:"Add event",type:"string",width:"340px",addField:!0,unique:!0,sortable:!0},{key:"subscribeOnConnect",label:"Listen",type:"boolean",width:"82px"}];t.default=(0,i.observer)((({model:e,highlight:t})=>{const s=a.useRef(-1),n=e.status===r.CONNECTED;return c[0].onEdit=(t,a)=>{n&&a<e.events.length&&(s.current=a,e.unsubscribe(e.events[a].name,a))},c[1].onToggle=(t,s)=>{n&&e.toggleSubscription(t.name,s)},a.createElement(l,{className:"websocket-events",highlight:t},a.createElement(o.TableEditor,{columns:c,rows:e.events,onUpdate:t=>{-1!==s.current&&(t[s.current].subscribeOnConnect=!1),e.set("events",t),s.current=-1},onDelete:t=>e.unsubscribe(t.name),deleteIconStyles:{position:"absolute",rightSpacing:"var(--spacing-xs)"}}))}))},7421:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(2102),o=s.n(i),r=s(3887),l=s(4992),c=s(7422),d=s(1821),u=s(12);const h=(0,d.c)(class extends a.Component{constructor(e){super(e),this.handleHeadersChange=this.handleHeadersChange.bind(this)}handleHeadersChange(e){const{model:t}=this.props;t.connectionConfigEditDisabled||t.set("headers",u.map(e,(e=>u.pick(e,["key","value","description","enabled"]))))}render(){const{model:e}=this.props;return a.createElement("div",{className:o()({"layout-1-column":!0,"websocket-headers":!0})},a.createElement(r.default,{onChange:this.handleHeadersChange,headers:e.headers||[],readOnly:e.connectionConfigEditDisabled,keySuggestions:(0,l.getHeadersKeySuggestions)(),previewHeaders:(0,c.getPreviewHeaders)(),prepareHeadersForPreview:c.prepareHeadersForPreview,canOverridePreviewHeader:c.canOverridePreviewHeader}))}},[n.observer]);t.default=h},7424:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(1006),o=s(3893),r=s(1821),l=s(12);const c=(0,r.c)(class extends a.Component{constructor(e){super(e),this.handleParamsChange=this.handleParamsChange.bind(this)}handleParamsChange(e,t){const{model:s}=this.props;s.connectionConfigEditDisabled||(0,i.transaction)((()=>{s.set("queryParams",l.map(e,(e=>{const t=l.pick(e,["key","value","description","enabled"]);return"string"!=typeof t.description&&delete t.description,t}))),s.set("url",t)}))}render(){const{model:e}=this.props;return a.createElement("div",{className:"websocket-query-params"},a.createElement(o.default,{url:e.url||"",params:e.queryParams||[],onParamsChange:this.handleParamsChange,readOnly:e.connectionConfigEditDisabled}))}},[n.observer]);t.default=c},7423:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(3956),o=s(4994),r=s(4946),l=s(1821),c=s(12);const d=(0,l.c)(class extends a.Component{handleFieldChange(e,t){const{model:s}=this.props;if(s.connectionConfigEditDisabled)return;const a=s.settings||{};s.set("settings",{...a,[e]:t})}handleRestoreDefault(e){const{model:t}=this.props;if(t.connectionConfigEditDisabled)return;const s={...t.settings||{}};delete s[e],t.set("settings",s)}render(){const{model:e}=this.props,t=e.type===r.WEBSOCKET_REQUEST_TYPE.SOCKETIO?o.SOCKETIO_CONNECTION_CONFIG:r.WS_CONNECTION_CONFIG;return a.createElement("div",{className:"websocket-settings"},c.map(t,(t=>a.createElement(i.default,{key:t.id,title:t.title,description:t.description,value:c.get(e.settings,[t.id]),defaultValue:t.defaultValue,inputFieldType:t.inputFieldType,inputType:t.inputType,handleFieldChange:this.handleFieldChange.bind(this,t.id),handleRestoreDefault:this.handleRestoreDefault.bind(this,t.id),menuOptions:t.menuOptions,menuLabels:t.menuLabels,disabled:e.connectionConfigEditDisabled,id:t.id}))))}},[n.observer]);t.default=d},7417:function(e,t,s){s.r(t);var a=s(1),n=s(1006),i=s(2098),o=s(2810),r=s(3894),l=s(2126),c=s(4386),d=s(4957),u=s(4992),h=s(4946),p=s(1821),m=s(12);const E=(0,l.default)(c.Button).withConfig({displayName:"WebSocketURLEditor__StyledButton",componentId:"postman-app__sc-j6fpf6-0"})(["height:fit-content;align-self:start;padding:var(--spacing-m) var(--spacing-l);width:80px;"]),g=l.default.div.withConfig({displayName:"WebSocketURLEditor__WebSocketURLContainer",componentId:"postman-app__sc-j6fpf6-1"})(["display:flex;padding:var(--spacing-s) var(--spacing-l);align-items:center;"]),S=l.default.div.withConfig({displayName:"WebSocketURLEditor__UrlWrapper",componentId:"postman-app__sc-j6fpf6-2"})(["display:flex;flex:1;width:100%;height:40px;box-sizing:border-box;& > *:not(:last-child){margin-right:var(--spacing-s);}"]),_=(0,p.c)(class extends a.Component{constructor(e){super(e),this.handleConnection=this.handleConnection.bind(this),this.handleUrlChange=this.handleUrlChange.bind(this),this.state={isFocused:!1,connectError:!1,requestType:e.model.type},this.urlEditorRef=a.createRef(null)}componentDidUpdate(e){this.props.model.type!==e.model.type&&this.setState({connectError:!1})}handleUrlChange(e){const{model:t}=this.props;if(t.connectionConfigEditDisabled)return;const s=(0,r.handleParamsChange)(e,t.queryParams||[]);(0,n.transaction)((()=>{this.setState({connectError:!1}),t.set("url",e),t.set("queryParams",m.map(s,(e=>{const t=m.pick(e,["key","value","description","enabled"]);return"string"!=typeof t.description&&delete t.description,t})))}))}handleConnection(){const e=h.WEBSOCKET_STATUS_TO_ACTION_MAP[this.props.model.status],{handler:t}=h.ACTION_TO_BUTTON_MAP[e];if(e===h.CONNECT){if(this.connectDisabled)return void this.setState({connectError:!0});d.default.setNonHTTPRequestSent()}!0===this.state.connectError&&this.setState({connectError:!1}),t&&this.props.model[t]&&this.props.model[t]()}static getDerivedStateFromProps(e,t){return e.model.type!==t.requestType?{isFocused:!1,requestType:e.model.type}:null}render(){const{url:e,status:t,connectionConfigEditDisabled:s,type:n,collection:i,context:r}=this.props.model,l=h.WEBSOCKET_STATUS_TO_ACTION_MAP[t],{label:d}=h.ACTION_TO_BUTTON_MAP[l],{isDisabled:p,reason:m}=(0,u.isConnectDisabled)(n,e),_="OSX"===pm.app.get("platform"),y=l===h.CONNECT?a.createElement(o.default,{content:_?"â†µ":"Enter",placement:"bottom"}):void 0;return this.connectDisabled=p,a.createElement(g,null,a.createElement(S,null,a.createElement(c.URLSuggestionsPopover,{trigger:a.createElement(c.AutoSuggestInput,{baseAutoSuggestKey:this.props.model.type,ref:this.urlEditorRef,enableVariableSuggestions:!0,error:this.state.connectError&&m?m:null,onChange:this.handleUrlChange,onHardFocus:()=>this.setState({isFocused:!0}),onSubmit:this.handleConnection,placeholder:"Enter URL",preventEnter:!0,readOnly:s,value:e,shouldFocusOnMount:!(i||null!=r&&r.isHistory),shouldHaveBorderHighlight:this.state.isFocused,dataTestId:`${this.props.model.type}-url-bar`}),attachTo:this.urlEditorRef,onChange:this.handleUrlChange,onClickOutside:()=>this.setState({isFocused:!1}),showSuggestions:this.state.isFocused,value:e,type:this.props.model.type}),a.createElement(E,{variant:l===h.CONNECT?"cta":"secondary",onClick:this.handleConnection,text:d,tooltip:y,"data-testid":"ws-raw-connect-button",className:"webSocketConnect"})))}},[i.observer]);t.default=_},7401:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(2101),o=s(2802),r=s(1929),l=s(2111),c=s(3786),d=s(4386),u=s(2126),h=s(7402),p=s(7414),m=s(7417),E=s(7418),g=s(7419),S=s(7431),_=s(7432),y=s(4946),T=s(1821);const f={[c.REQUESTER_TAB_LAYOUT_1_COLUMN]:l.PANE_LAYOUT_VERTICAL,[c.REQUESTER_TAB_LAYOUT_2_COLUMN]:l.PANE_LAYOUT_HORIZONTAL},v=(0,u.default)(i.PaneGroup).withConfig({displayName:"WebSocketEditor__StyledPaneGroup",componentId:"postman-app__sc-14co8ht-0"})([".pane-label{.pane-label__text{font-family:var(--text-family-default);font-weight:var(--text-weight-bold);font-size:var(--text-size-m);line-height:var(--line-height-m);color:var(--content-color-primary);}&.horizontal{.pane-label__text{margin-left:var(--spacing-l);}.pane-label__arrow{margin-right:var(--spacing-l);}}}"]),b=(0,T.c)(class extends a.Component{constructor(e){super(e),this.handleStreamPaneToggle=this.handleStreamPaneToggle.bind(this),this.handleConnectionPaneToggle=this.handleConnectionPaneToggle.bind(this),this.unCollapseConnectionPane=this.unCollapseConnectionPane.bind(this),this.currentLayout=e.model.layoutName,this.connectionPaneWidth=this.connectionPaneWidth.bind(this),this.state={highlightEventsTab:!1}}componentDidUpdate(){const e=this.props.model.layoutName;this.currentLayout!==e&&(this.currentLayout=e,this.editorPaneGroupRef&&"function"==typeof this.editorPaneGroupRef.setLayout&&this.editorPaneGroupRef.setLayout(f[this.currentLayout]))}connectionPaneWidth(){return this.connectionPaneRef&&this.connectionPaneRef.state.width}handleStreamPaneToggle(){this.streamPaneRef&&(this.currentLayout===c.REQUESTER_TAB_LAYOUT_1_COLUMN?this.streamPaneRef.handleCollapseToggle("y"):this.streamPaneRef.handleCollapseToggle("x"))}handleConnectionPaneToggle(){this.connectionPaneRef&&(this.currentLayout===c.REQUESTER_TAB_LAYOUT_1_COLUMN?this.connectionPaneRef.handleCollapseToggle("y"):this.connectionPaneRef.handleCollapseToggle("x"))}unCollapseConnectionPane(){this.connectionPaneRef&&this.connectionPaneRef.unCollapse("y")}renderCoreEditor(){const{model:e}=this.props;return a.createElement(d.View,{position:"relative",height:"full",width:"full"},a.createElement(d.Flex,{position:"absolute",isColumn:!0,height:"full",width:"full"},a.createElement(_.default,{model:e,switchType:this.props.switchType}),a.createElement(m.default,{model:e}),a.createElement(v,{defaultLayout:f[e.layoutName],key:"WebsocketRequestPaneGroup",onPaneResize:this.handlePaneResize,ref:e=>{this.editorPaneGroupRef=e}},a.createElement(i.Pane,{height:{default:r.default.ui.WEBSOCKET_REQUEST_URL_PANE_DEFAULT_HEIGHT,min:r.default.ui.WEBSOCKET_REQUEST_URL_PANE_MIN_HEIGHT,collapsed:r.default.ui.WEBSOCKET_REQUEST_URL_PANE_COLLAPSED_HEIGHT,uncollapsed:r.default.ui.WEBSOCKET_REQUEST_URL_PANE_UNCOLLAPSED_HEIGHT},width:{default:r.default.ui.WEBSOCKET_REQUEST_PANE_DEFAULT_WIDTH,min:r.default.ui.WEBSOCKET_REQUEST_PANE_EDITOR_OPEN_MIN_WIDTH,collapsed:r.default.ui.WEBSOCKET_REQUEST_PANE_COLLAPSED_WIDTH,uncollapsed:r.default.ui.WEBSOCKET_REQUEST_PANE_UNCOLLAPSED_WIDTH},ref:e=>{this.connectionPaneRef=e}},a.createElement(i.PaneHeader,{height:32,width:r.default.ui.WEBSOCKET_REQUEST_PANE_COLLAPSED_WIDTH,defaultLayout:l.PANE_LAYOUT_HORIZONTAL,horizontalComponent:a.createElement(E.default,{model:e,onSelect:this.unCollapseConnectionPane,onClick:this.handleConnectionPaneToggle,layout:e.layoutName,connectionPaneWidth:this.connectionPaneWidth}),verticalComponent:a.createElement(i.PaneLabel,{layout:l.PANE_LAYOUT_VERTICAL,label:a.createElement(o.default,{type:"body-medium",color:"content-color-secondary"},"Request"),arrowDirection:"right",onClick:this.handleConnectionPaneToggle})}),a.createElement(i.PaneContent,{height:{default:r.default.ui.WEBSOCKET_REQUEST_URL_PANE_DEFAULT_HEIGHT}},a.createElement(g.default,{model:e,highlightEventsTab:this.state.highlightEventsTab}))),a.createElement(i.Pane,{ref:e=>{this.streamPaneRef=e},height:{default:r.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_DEFAULT_HEIGHT,min:r.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_MIN_HEIGHT,collapsed:r.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_COLLAPSED_HEIGHT,uncollapsed:r.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_UNCOLLAPSED_HEIGHT},width:{default:r.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_DEFAULT_WIDTH,min:r.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_MIN_WIDTH,collapsed:r.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_COLLAPSED_WIDTH,uncollapsed:r.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_UNCOLLAPSED_WIDTH}},a.createElement(i.PaneHeader,{height:32,width:r.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_COLLAPSED_WIDTH,defaultLayout:l.PANE_LAYOUT_HORIZONTAL,horizontalComponent:a.createElement(S.default,{label:"Response",icon:e=>e?"icon-direction-up":"icon-direction-down",status:e.badgeStatus,statistics:e.connectionStatistics,onClick:this.handleStreamPaneToggle,layout:e.layoutName,model:e,onHighLightEventsTab:()=>{this.setState({highlightEventsTab:!0}),setTimeout((()=>this.setState({highlightEventsTab:!1})),200)}}),verticalComponent:a.createElement(i.PaneLabel,{layout:l.PANE_LAYOUT_VERTICAL,label:a.createElement(o.default,{type:"body-medium",color:"content-color-secondary"},"Response"),arrowDirection:"left",onClick:this.handleStreamPaneToggle})}),a.createElement(i.PaneContent,null,e.type===y.WEBSOCKET_REQUEST_TYPE.RAW?a.createElement(h.default,{model:e}):a.createElement(p.default,{model:e}))))))}render(){return this.renderCoreEditor()}},[n.observer]);t.default=b},7432:function(e,t,s){s.r(t);var a=s(1),n=s(3060),i=s(4382),o=s(2098),r=s(2884),l=s(3044),c=s(4579),d=s(4564),u=s(3049),h=s(4578),p=s(3790),m=s(5619),E=s(5621),g=s(1799),S=s(5055),_=s(5045),y=s(2221),T=s(5052),f=s(2091),v=s(12);const b=(0,o.observer)((e=>{const{requestSDK:t}=e.model,s=(0,a.useRef)(null),{isSavedRequest:o}=e.model,b=t.isOnline(),C=t.hasPermission(e.model.id,d.ItemAction.SAVE),M=b&&C,O=(e.model.isDirty||!o)&&M,A=b,N=g.default.isEnabled,I=()=>{if(o)return e.model.requestWorkbenchSave&&e.model.requestWorkbenchSave();e.model.saveAs()},w=(t,a)=>{e.model.requestSDK.menuActionHandler(e.model.id,t,a).then((()=>{if(t===d.ItemAction.RENAME_TOGGLE)v.invoke(s,"current.handleEditName")}))},k=()=>A?"Save request to a collection":b?u.DISABLED_TOOLTIP_NO_PERMISSION:u.DISABLED_TOOLTIP_IS_OFFLINE;return(0,a.useEffect)((()=>{const{model:t}=e;v.get(t,"context.rename")&&(w(d.ItemAction.RENAME_TOGGLE),t&&v.isFunction(t.unsetContext)&&t.unsetContext("rename"))}),[]),a.createElement(l.default,{className:"websocket-editor-header",ref:s,name:e.model.name,path:e.model.breadcrumbPath,entityType:`ec:${t.type}`,entityUID:e.model.isSavedRequest?e.model.id:null,isEntityEditable:M&&e.model.isSavedRequest,onBreadCrumbItemClick:e=>{if(e)if(e.type===h.COLLECTION)c.default.openInTab(e.id);else{const t=pm.ECItemRegistry.getSDK(e.type);t&&t.openInTab(e.id)}},onSubmit:e=>w(d.ItemAction.RENAME,{name:e}),leftMetaComponent:()=>{var s;return a.createElement(_.default,{activeValue:t.type,tabId:e.model.context.tabId,canSwitch:!(o||null!==(s=e.model)&&void 0!==s&&null!==(s=s.context)&&void 0!==s&&s.isHistory),beforeSwitch:()=>e.model.cacheUpdatesBuffer()})},renderActions:()=>a.createElement("div",{className:"websocket-editor-header__actions"},a.createElement("div",{className:"request-editor-save-button"},N?(()=>{const e=a.createElement(n.default,{icon:a.createElement(y.default,null),text:"Save",type:"tertiary","data-testid":"add-to-collection-button"});return a.createElement(i.default,{placement:"bottom-end",padding:"spacing-xs",maxWidth:"350px",trigger:e,pointer:"true"},a.createElement(T.default,{title:S.GENERIC_SIGNIN_MODAL_TITLE,subtitle:S.GENERIC_SIGNIN_MODAL_SUBTITLE}))})():a.createElement(r.Dropdown,{onSelect:()=>e.model.saveAs()},a.createElement(r.DropdownButton,{dropdownStyle:"split",type:"secondary"},a.createElement("div",null,a.createElement(n.default,{type:"secondary",text:"Save",icon:"icon-action-save-stroke",onClick:I,isDisabled:o?!O:!A,tooltip:o?b?C?e.model.isDirty?"Save request":"No new changes to save.":u.DISABLED_TOOLTIP_NO_PERMISSION:u.DISABLED_TOOLTIP_IS_OFFLINE:k()}))),a.createElement(r.DropdownMenu,{"align-right":!0,className:"request-editor-save-button-dropdown"},a.createElement(r.MenuItem,{refKey:"save-as",disabled:!A,disabledText:k()},a.createElement("div",{className:"dropdown-menu-item-label"},"Save As.."),a.createElement("div",{className:"dropdown-menu-item-shortcut"},(0,p.getShortcutByName)("saveCurrentRequestAs")))))),f.default.isUseBrowserTabsActive()&&a.createElement("div",{className:"environment-container"},a.createElement(m.default,{selectorWidth:130,useBrowserTabs:!0}),a.createElement("div",{className:"environment-splitter"}),a.createElement(E.default,{useBrowserTabs:!0}))),breadCrumbRouteConfig:e=>{if(e)return e.type===h.COLLECTION?{routeIdentifier:"build.collection",routeParams:{cid:e.id},queryParams:null}:pm.ECItemRegistry.getSDK(e.type)?{routeIdentifier:pm.ECItemRegistry.getSDK(e.type).openSavedIdentifier,routeParams:{ecid:e.id},queryParams:{}}:null}})}));t.default=b},7404:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(2802),o=s(3060),r=s(2112),l=s(1821),c=s(12);const d=(0,l.c)(class extends a.Component{constructor(e){super(e),this.handleRestore=this.handleRestore.bind(this)}handleRestore(){this.props.model.restoreHiddenMessages&&this.props.model.restoreHiddenMessages()}render(){return a.createElement("div",{className:"websocket-hidden-messages"},a.createElement("div",{className:"websocket-hidden-messages__left-section"},a.createElement(r.default,{name:"icon-action-hide-stroke",color:"content-color-primary",size:"large",className:"websocket-hidden-messages__left-section__icon"}),a.createElement(i.default,{type:"body-medium",color:"content-color-primary"},`${c.get(this.props.model,"firstVisibleMessageIndex")} messages hidden`)),a.createElement("div",{className:"websocket-hidden-messages__right-section"},a.createElement(o.default,{type:"secondary",text:"Restore",size:"small",onClick:this.handleRestore})))}},[n.observer]);t.default=d},7412:function(e,t,s){s.r(t);var a=s(1),n=s(2102),i=s.n(n),o=s(2098),r=s(3060),l=s(4905),c=s(3657),d=s(3081),u=s(4947),h=s(7413),p=s(4992),m=s(4946),E=s(1821),g=s(12);const S=(0,E.c)(class extends a.Component{constructor(e){super(e),this.loadMedia=this.loadMedia.bind(this),this.handleBeautify=this.handleBeautify.bind(this),this.toggleLineWrap=this.toggleLineWrap.bind(this),this.toggleFindWidget=this.toggleFindWidget.bind(this),this.toggleHexdump=this.toggleHexdump.bind(this),this.handleMessageLanguageChange=this.handleMessageLanguageChange.bind(this)}getToolbarClasses(){return i()({"websocket-message-viewer__editor__toolbar":!0,"is-binary":null===g.get(this.props,"cachedState.activeLanguage")})}getLineWrapButtonClasses(){return i()({"line-wrap-active":g.get(this.props,"cachedState.lineWrap")})}loadMedia(e){const t={mediaType:this.props.mimeType,fileExtension:this.props.fileExtension};pm.runtime.getPreviewFile(e,t,((e,t)=>{if(e)return pm.logger.error("ResponsePreviewService~saveMediaResponseV2: Could not save preview.",e);this.props.onMediaSave&&this.props.onMediaSave(t.value)}))}handleStateUpdate(e={}){this.props.updateState(g.assign({activeLanguage:g.get(this.props,"cachedState.activeLanguage"),lineWrap:g.get(this.props,"cachedState.lineWrap"),hexMode:g.get(this.props,"cachedState.hexMode")},e))}handleMessageLanguageChange(e){this.handleStateUpdate({activeLanguage:e,hexMode:!1})}handleBeautify(){this.editorRef&&this.editorRef.prettify()}toggleLineWrap(){this.handleStateUpdate({lineWrap:!g.get(this.props,"cachedState.lineWrap")})}toggleFindWidget(){this.editorRef&&this.editorRef.toggleFindWidget()}toggleHexdump(){this.handleStateUpdate({hexMode:!g.get(this.props,"cachedState.hexMode")})}renderIFrame(e){return!this.props.mediaFilePath&&this.loadMedia(e),a.createElement("div",{className:"websocket-message-viewer__iframe"},this.props.mediaFilePath?a.createElement(l.default,{responseStream:e,url:this.props.mediaFilePath}):a.createElement(c.default,null))}renderEditor(e){const{activeLanguage:t,lineWrap:s,hexMode:n}=this.props.cachedState||{};let i=g.get(this.props,"cachedState.activeLanguage");return n?i=u.WebSocketMessageBodyType.HEXDUMP:g.isNil(t)&&(i=u.WebSocketMessageBodyType.TEXT),a.createElement("div",{className:"websocket-message-viewer__editor"},a.createElement("div",{className:this.getToolbarClasses()},!g.isNil(t)&&a.createElement("div",{className:"websocket-message-viewer__editor__toolbar__section-l"},a.createElement(h.default,{onChange:this.handleMessageLanguageChange,activeLanguage:t}),a.createElement(r.default,{onClick:this.toggleLineWrap,type:"tertiary",icon:"icon-action-wrap-stroke",tooltip:"Wrap Line",className:this.getLineWrapButtonClasses(),isDisabled:n}),!this.props.autoFormat&&a.createElement(r.default,{onClick:this.handleBeautify,type:"tertiary",icon:"icon-action-pretty-stroke",tooltip:"Beautify",isDisabled:n})),a.createElement("div",{className:"websocket-message-viewer__editor__toolbar__section-r"},a.createElement(r.default,{onClick:this.toggleHexdump,type:"tertiary",text:n?"Show Message":"Show Hexdump"}),a.createElement(r.default,{onClick:this.toggleFindWidget,type:"tertiary",icon:"icon-action-search-stroke",tooltip:"Search"}))),a.createElement("div",{className:"websocket-message-viewer__editor__monaco-editor"},a.createElement(d.default,{autoFormat:this.props.autoFormat,value:e,fontSize:12,language:i,wordWrap:s,readOnly:!0,ref:e=>{this.editorRef=e}})))}render(){const{message:e,viewer:t}=(0,p.transformMessage)(this.props.message,this.props.mimeType,g.get(this.props,"cachedState.hexMode"));return this.transformedMessage=e,t===m.IFRAME?this.renderIFrame(e):this.renderEditor(e)}},[o.observer]);t.default=S,S.defaultProps={autoFormat:!0}},7413:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var a=s(1),n=s(2884),i=s(2537),o=s(4947),r=s(4946),l=s(12);const c={[o.WebSocketMessageBodyType.TEXT]:r.USER_FRIENDLY_LANGUAGE_NAME[o.WebSocketMessageBodyType.TEXT],[o.WebSocketMessageBodyType.HTML]:r.USER_FRIENDLY_LANGUAGE_NAME[o.WebSocketMessageBodyType.HTML],[o.WebSocketMessageBodyType.POSTMAN_JSON]:r.USER_FRIENDLY_LANGUAGE_NAME[o.WebSocketMessageBodyType.POSTMAN_JSON],[o.WebSocketMessageBodyType.XML]:r.USER_FRIENDLY_LANGUAGE_NAME[o.WebSocketMessageBodyType.XML]};function d(e){const t=e.languageMap||c;return a.createElement(n.Dropdown,{className:e.className,onSelect:e.onChange},a.createElement(n.DropdownButton,{type:"tertiary",size:"small"},a.createElement(i.Button,{className:"websocket-message-lang-dropdown-btn"},t[e.activeLanguage])),a.createElement(n.DropdownMenu,{fluid:!0},l.map(t,((e,t)=>a.createElement(n.MenuItem,{refKey:t,key:t},a.createElement("span",null,e))))))}},7431:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(2126),o=s(2872),r=s(2802),l=s(3057),c=s(3060),d=s(2538),u=s(2364),h=s(2370),p=s(2372),m=s(3786),E=s(4946),g=s(1821),S=s(12);const _=(0,i.default)(o.default).withConfig({displayName:"WebSocketMessagePaneLabel__StyledFlex",componentId:"postman-app__sc-1wmdki6-0"})(["cursor:default;"]),y=i.default.div.withConfig({displayName:"WebSocketMessagePaneLabel__StyledDiv",componentId:"postman-app__sc-1wmdki6-1"})(["display:flex;align-items:center;gap:var(--spacing-s);"]),T=i.default.div.withConfig({displayName:"WebSocketMessagePaneLabel__StyledBadge",componentId:"postman-app__sc-1wmdki6-2"})(["display:inline-flex;width:8px;height:8px;margin-left:var(--spacing-xs);background-color:",";border-radius:8px;"],(({status:e})=>{switch(e){case"success":return"var(--base-color-success)";case"info":return"var(--base-color-warning)";case"critical":return"var(--base-color-error)"}}));function f(e){const{label:t,value:s}=e;return t&&s?a.createElement("div",{className:"websocket-connection-statistics__item"},a.createElement(r.default,{type:"body-medium",color:"content-color-secondary",className:"websocket-connection-statistics__item__label"},t),a.createElement("div",{className:"websocket-connection-statistics__item__value",title:s},a.createElement(r.default,{type:"body-medium",color:"content-color-primary"},s))):null}function v(e){if(!e.section)return null;const{section:t,dataFields:s}=e.section;return a.createElement(a.Fragment,null,t&&a.createElement("div",{className:"websocket-connection-statistics__item"},a.createElement(l.default,{type:"h5",color:"content-color-secondary",text:t,className:"websocket-connection-statistics__item__header"})),S.map(s,(({key:t,label:s,formatter:n})=>{const i=S.get(e.statistics,[t]);return a.createElement(f,{key:t,label:s,value:S.isFunction(n)?n(i):i})})))}const b=(0,g.c)(class extends a.Component{constructor(e){super(e),this.state={isStatisticsVisible:!1},this.showStatistics=this.showStatistics.bind(this),this.hideStatistics=this.hideStatistics.bind(this),this.openEventsTab=this.openEventsTab.bind(this)}showStatistics(){this.props.statistics&&(this.dismissTooltipTimeout&&clearTimeout(this.dismissTooltipTimeout),this.dismissTooltipTimeout=setTimeout((()=>{this.setState({isStatisticsVisible:!0})}),100))}hideStatistics(){this.props.statistics&&(this.dismissTooltipTimeout&&clearTimeout(this.dismissTooltipTimeout),this.dismissTooltipTimeout=setTimeout((()=>{this.setState({isStatisticsVisible:!1})}),300))}openEventsTab(){this.props.model.activeConnectionTab===E.WEBSOCKET_CONNECTION_EVENTS?this.props.onHighLightEventsTab():this.props.model.set("activeConnectionTab",E.WEBSOCKET_CONNECTION_EVENTS)}renderToggle(e,t){let s=e===m.REQUESTER_TAB_LAYOUT_1_COLUMN?u.default:h.default;return t&&e===m.REQUESTER_TAB_LAYOUT_1_COLUMN&&(s=p.default),a.createElement(s,{color:"content-color-tertiary"})}render(){var e;const{status:t,icon:s,isCollapsed:n,layout:i,model:o}=this.props,{label:u,type:h}=E.WEBSOCKET_STATUS_TO_BADGE_MAP[t]||{},p=S.isString(s)?s:S.isFunction(s)&&s(this.props.isCollapsed),m=null!==(e=o.activeEventsCount)&&void 0!==e?e:0,g=o.activeEventsCount<1?"Not listening to events":`Listening to ${m} ${"1"===m?"event":"events"}`;return a.createElement("div",{className:"websocket-message-pane-label"},a.createElement("div",{className:"websocket-message-pane-label__text",onClick:this.props.onClick},a.createElement(l.default,{type:"h5",text:this.props.label,color:"content-color-primary"})),a.createElement("div",{className:"websocket-message-pane-label__actions"},u&&h&&a.createElement(a.Fragment,null,a.createElement(_,{alignItems:"center",gap:"spacing-xs"},(null==o?void 0:o.type)===E.WEBSOCKET_REQUEST_TYPE.SOCKETIO&&o.status!==E.IDLE?a.createElement(c.default,{type:"tertiary",size:"small",text:g,onClick:this.openEventsTab}):null,a.createElement(y,{onMouseEnter:this.showStatistics,onMouseLeave:this.hideStatistics,ref:e=>{this.badgeRef=e}},a.createElement(T,{status:h}),a.createElement(r.default,{"data-testid":"websocket-connection-status-label"},u))),!S.isEmpty(this.props.statistics)&&a.createElement(d.Tooltip,{placement:"bottom",className:"websocket-connection-statistics",target:this.badgeRef,show:this.state.isStatisticsVisible,onMouseEnter:this.showStatistics,onMouseLeave:this.hideStatistics,immediate:!0},a.createElement(d.TooltipBody,null,S.map(E.WS_CONNECTION_STATS_TEMPLATE,((e,t)=>a.createElement(v,{key:t,section:e,statistics:this.props.statistics})))))),p&&a.createElement("div",{className:"websocket-message-pane-label__actions__arrow",onClick:this.props.onClick},this.renderToggle(i,n))))}},[n.observer]);t.default=b},7403:function(e,t,s){s.r(t);var a=s(1),n=s(1006),i=s(2098),o=s(2875),r=s(2102),l=s.n(r),c=s(3060),d=s(3056),u=s(7409),h=s(7410),p=s(4612),m=s(3916),E=s(1826),g=s(3657),S=s(3059),_=s(7404),y=s(7405),T=s(7408),f=s(4946),v=s(1821),b=s(12);const C=(0,i.observer)((e=>e.model.messageStreamNotificationType?a.createElement("div",{className:"websocket-stream__jump-to-latest"},a.createElement(c.default,{type:"tertiary",size:"small",text:e.model.messageStreamNotificationType===f.MESSAGE_STREAM_NOTIFICATION_NEW?"New messages":"Jump to latest",icon:"icon-direction-ascend-small",className:"websocket-stream__jump-to-latest__btn",onClick:e.handleJumpToLatest})):null)),M=(0,v.c)(class extends a.Component{constructor(e){super(e),this.state={retryCount:0},this.handleMessageLoadRetry=this.handleMessageLoadRetry.bind(this),this.getItemSize=this.getItemSize.bind(this),this.getListItem=this.getListItem.bind(this),this.onItemsRendered=this.onItemsRendered.bind(this),this.handleJumpToLatest=this.handleJumpToLatest.bind(this),this.handleListScroll=this.handleListScroll.bind(this)}componentDidMount(){const{model:e}=this.props;this.resetHeightReactionDisposer=(0,n.reaction)((()=>e.visibleItems),(()=>this.handleResetHeight(0))),this.newMessageNotificationReactionDisposer=(0,n.reaction)((()=>b.size(e.newMessages)),(t=>{if(0===t)return e.set("messageStreamNotificationType",null);e.set("messageStreamNotificationType",f.MESSAGE_STREAM_NOTIFICATION_NEW)}))}componentWillUnmount(){this.resetHeightReactionDisposer&&this.resetHeightReactionDisposer(),this.newMessageNotificationReactionDisposer&&this.newMessageNotificationReactionDisposer()}onItemsRendered({visibleStartIndex:e}){e<10||b.size(this.props.model.newMessages)||this.props.model.set("messageStreamNotificationType",f.MESSAGE_STREAM_NOTIFICATION_JUMP_TO_LATEST)}get emptyState(){return{error:{title:{text:"Couldnâ€™t load your messages."},message:{text:this.state.retryCount<3?"Just a faulty wire. Please try again.":"We are unable to load your messages due to unforeseen circumstances. Please try again later.",className:"stream-empty-state__message"},illustration:a.createElement(d.default,null),secondaryAction:this.state.retryCount<3?{label:"Retry",type:"outline",onClick:this.handleMessageLoadRetry}:{}},empty:{message:{text:"Establish a connection to send and receive messages.",className:"stream-empty-state__message"},illustration:a.createElement(u.default,null)}}}getMessageIndex(e){return b.size(this.props.model.visibleItems)-(e+1)}getItemSize(e){const{model:t}=this.props,{id:s,type:a,payload:n}=b.get(t,["visibleItems",this.getMessageIndex(e)],{});return t.expandedMessageSet.has(s)?a===f.WEBSOCKET_ERROR_MESSAGE||a===f.WEBSOCKET_CONNECTED_MESSAGE?n&&b.isNil(n.handshakeDetails)?73:281:a===f.WEBSOCKET_DISCONNECTED_MESSAGE?73:291:41}getListItem(e){const{model:t}=this.props,s=b.get(t,["visibleItems",this.getMessageIndex(e.index)]);return s?s.type===f.WEBSOCKET_HIDDEN_MESSAGE?a.createElement("div",{style:e.style},a.createElement(_.default,{model:t})):a.createElement("div",{style:e.style},this.props.renderListItem(e.index,s)):null}getList(){const e=e=>a.createElement(i.Observer,null,this.getListItem.bind(this,e)),t=({height:t,width:s})=>a.createElement(i.Observer,null,(()=>a.createElement(o.VariableSizeList,{height:t,width:s,itemSize:this.getItemSize,itemCount:b.size(this.props.model.visibleItems),overscanCount:5,ref:e=>{this.listRef=e},onItemsRendered:this.onItemsRendered,onScroll:this.handleListScroll},e)));return a.createElement("div",{className:"websocket-stream__list"},a.createElement(p.default,null,t))}handleMessageLoadRetry(){this.setState((e=>({retryCount:e.retryCount+1}))),this.props.model.set("messageStreamStatus",f.WEBSOCKET_MESSAGE_STREAM_STATUS.Loading),T.default.fetchHistoryMessages((0,m.resolveStoreInstance)(E.default).id,this.props.model.id).then((e=>{this.props.model.onMessageStreamFetch(null,e)})).catch((e=>{this.props.model.onMessageStreamFetch(e),pm.logger.error("Error in loading message stream",e)}))}handleResetHeight(e){!b.isEmpty(this.listRef)&&this.listRef.resetAfterIndex(e)}handleJumpToLatest(e){e&&e.stopPropagation(),!b.isEmpty(this.listRef)&&this.listRef.scrollToItem(0)}handleListScroll({scrollOffset:e}){if(this.toolbarRef&&this.toolbarRef.onScroll(e),0===e){const e=this.props.model.messageStreamNotificationType;(0,n.transaction)((()=>{b.size(this.props.model.newMessages)&&this.props.model.flushNewMessages(),this.props.model.set("messageStreamNotificationType",null)})),e===f.MESSAGE_STREAM_NOTIFICATION_NEW&&this.handleResetHeight(0)}this.props.model.set("scrollOffset",e)}renderContent(){const{model:e}=this.props;return e.isFilterApplied&&b.isEmpty(e.filteredMessages)?a.createElement(S.default,{className:"stream-empty-state",illustration:a.createElement(h.default,null),title:{text:"No messages found"},message:{text:"Try again using a different keyword or filter."}}):a.createElement(a.Fragment,null,a.createElement(C,{model:e,handleJumpToLatest:this.handleJumpToLatest}),this.getList())}render(){const{model:e}=this.props;if(e.messageStreamStatus===f.WEBSOCKET_MESSAGE_STREAM_STATUS.Loading)return a.createElement(g.default,{className:"websocket-stream-loader"});let t;if(e.messageStreamStatus===f.WEBSOCKET_MESSAGE_STREAM_STATUS.Error?t="error":e.messageStreamStatus===f.WEBSOCKET_MESSAGE_STREAM_STATUS.Empty&&(t="empty"),t&&this.emptyState[t]){const{title:e,message:s,illustration:n,secondaryAction:i}=this.emptyState[t];return a.createElement(S.default,{className:"stream-empty-state",illustration:n,title:e,message:s,secondaryAction:i})}return a.createElement("div",{className:l()("websocket-stream",this.props.className)},a.createElement(y.default,{model:e,ref:e=>{this.toolbarRef=e}},this.props.toolbarExtras),this.renderContent())}},[i.observer]);t.default=M},7407:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(1006),o=s(2102),r=s.n(o),l=s(4481),c=s(3829),d=s(4507),u=s(4505),h=s(2802),p=s(4509),m=s(4497),E=s(4510),g=s(3060),S=s(2112),_=s(2159),y=s(4386),T=s(3786),f=s(2126),v=s(4946),b=s(1821),C=s(12);const M=(0,f.default)(y.Flex).withConfig({displayName:"WebSocketMessageStreamControls__Container",componentId:"postman-app__sc-12eqnha-0"})(["display:flex;align-items:center;justify-content:center;min-height:var(--size-xs);min-width:var(--size-xs);background-color:",";"],(e=>e.background&&`var(--${e.background})`)),O=(0,b.c)(class extends a.Component{constructor(e){super(e),this.state={addShadow:!1,filterInput:this.props.model.messageFilter||""},this.handleHideAll=this.handleHideAll.bind(this),this.handleFilterDropdownSelect=this.handleFilterDropdownSelect.bind(this),this.handleFilterInput=this.handleFilterInput.bind(this),this.handleFilterClear=this.handleFilterClear.bind(this),this.debouncedOnFilterInput=C.debounce(this.onFilterInput.bind(this),300)}onFilterInput(e){(0,i.transaction)((()=>{this.props.model.flushNewMessages(),this.props.model.set("messageFilter",e)}))}onScroll(e){(0!==e||this.state.addShadow)&&(0!==e&&this.state.addShadow||this.setState((e=>({addShadow:!e.addShadow}))))}getClasses(){return r()({"websocket-message-stream-controls":!0,"add-shadow":this.state.addShadow})}getIcon(e){const t=v.MESSAGE_ICON_MAP[e]||!1;if(!t)return;const{name:s,color:n,size:i,backgroundColor:o}=t;return a.createElement(M,{background:o},a.createElement(S.default,{name:s,color:n,size:i}))}handleHideAll(){(0,i.transaction)((()=>{this.props.model.flushNewMessages(),this.props.model.hideAllMessages()}))}handleFilterDropdownSelect(e){(0,i.transaction)((()=>{this.props.model.flushNewMessages(),this.props.model.set("messageTypeFilter",e)}))}handleFilterInput(e){const t=C.get(e,"target.value");this.setState({filterInput:t}),this.debouncedOnFilterInput(t)}handleFilterClear(){this.setState({filterInput:""}),this.onFilterInput("")}render(){return a.createElement(y.Flex,{alignItems:"flex-start",className:this.getClasses()},a.createElement(y.Flex,{wrap:"wrap",rowGap:"spacing-s",gap:"spacing-s"},a.createElement("div",{className:"websocket-message-stream-controls__filter-input"},a.createElement(l.default,{type:"search",placeholder:"Search",value:this.state.filterInput,onChange:this.handleFilterInput,onClear:this.handleFilterClear,label:a.createElement(c.default,{text:"Search",isHidden:!0})})),a.createElement(y.Flex,null,a.createElement(d.default,null,a.createElement(u.default,{type:"tertiary",text:a.createElement(y.Flex,{gap:"spacing-xs",alignItems:"center"},this.getIcon(this.props.model.messageTypeFilter),a.createElement(h.default,null,v.MESSAGE_TYPE_FILTER_LABELS[this.props.model.messageTypeFilter]))}),a.createElement(p.default,{className:"websocket-message-stream-controls__filter-dropdown"},C.map(v.MESSAGE_TYPE_FILTER_LABELS,((e,t)=>"addSeparator"===t?a.createElement(m.default,null):a.createElement(E.default,{key:t,className:"message-type-filter-item",onClick:()=>this.handleFilterDropdownSelect(t)},this.getIcon(t),e))))),a.createElement(g.default,{type:"tertiary",icon:a.createElement(_.default,null),size:"medium",text:this.props.model.layoutName===T.REQUESTER_TAB_LAYOUT_1_COLUMN?"Clear Messages":null,tooltip:this.props.model.layoutName===T.REQUESTER_TAB_LAYOUT_1_COLUMN?null:"Clear Messages",onClick:this.handleHideAll,isDisabled:C.isEmpty(this.props.model.filteredMessages)&&this.props.model.hasMessagesToRestore}))),a.createElement("div",{className:"websocket-message-stream-controls__right-side"},this.props.children))}},[n.observer]);t.default=O},7406:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(3060),o=s(2802),r=s(1821);const l=(0,r.c)(class extends a.Component{constructor(e){super(e),this.handleDeselect=this.handleDeselect.bind(this)}handleDeselect(){this.props.model.deselectAllMessages&&this.props.model.deselectAllMessages()}render(){return a.createElement("div",{className:"message-relational-info-toolbar"},a.createElement(i.default,{type:"muted-plain",text:"Deselect",onClick:this.handleDeselect,className:"message-relational-info-toolbar__deselect"}),a.createElement(o.default,{type:"body-medium",color:"content-color-primary"},`Time difference: ${this.props.model.timeDifference}`))}},[n.observer]);t.default=l},7405:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(7406),o=s(7407),r=s(1821);const l=(0,r.c)(class extends a.Component{onScroll(e){this.streamControlsRef&&this.streamControlsRef.onScroll(e)}render(){const{model:e}=this.props;return 2===e.selectedMessageSet.size?a.createElement(i.default,{model:e}):a.createElement(o.default,{model:e,ref:e=>{this.streamControlsRef=e}},this.props.children)}},[n.observer]);t.default=l},7430:function(e,t,s){s.r(t);var a=s(1),n=s(4),i=s(2102),o=s.n(i),r=s(2098),l=s(4507),c=s(4505),d=s(3060),u=s(4509),h=s(4510),p=s(2800),m=s(2202),E=s(4564),g=s(3059),S=s(3046),_=s(3049),y=s(4946),T=s(4944),f=s(12);function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},v.apply(null,arguments)}t.default=(0,r.observer)((({model:e,unCollapseEditorPane:t})=>{const s=(0,a.useRef)(new Map),i=(0,a.useRef)(new Map),r=(0,a.useRef)(null),[b,C]=(0,a.useState)(0);function M(e){const t=s.current.get(e);t&&t.startEditing()}function O(e,t){const a=s.current.get(e);t&&a&&(a.focus(),a.selectAll())}function A(t,s){e.saveMessageProperty(t,"title",s)}function N(n,r){const{eventName:p}=n.initialState,g=t=>{const s=e.messageSDK.hasPermission(n.get("id"),t);return{isDisabled:!s,tooltip:(()=>{if(!s)return _.DISABLED_TOOLTIP_NO_PERMISSION})()}};return a.createElement("div",{key:n.get("id"),onClick:()=>function(s){e.selectSavedMessage(s),t()}(n),className:o()({"websocket-saved-messages__message":!0,"websocket-saved-messages__message--selected":n===e.currentComposeMessage}),ref:e=>i.current.set(r,e)},void 0!==p&&a.createElement(T.default,{name:p,color:e.eventsCache.getColor(p)}),a.createElement("div",{className:"websocket-saved-messages__message-title",title:n.initialState.title},a.createElement(S.default,{value:n.initialState.title,onSubmit:A.bind(null,n),onToggleEdit:O.bind(null,r),ref:e=>s.current.set(r,e),placeholder:"Message Title"})),a.createElement("div",{className:"websocket-saved-messages__right-side"},a.createElement("div",{className:"websocket-saved-messages__message-menu"},a.createElement(l.default,null,a.createElement(c.default,{className:"websocket-saved-messages__more-options"},a.createElement(d.default,{icon:a.createElement(m.default,null)})),a.createElement(u.default,null,a.createElement(h.default,v({},g(E.ItemAction.RENAME),{onClick:()=>M(r)}),a.createElement("span",null,"Rename")),a.createElement(h.default,v({},g(E.ItemAction.DUPLICATE),{onClick:()=>e.duplicateSavedMessage(n)}),a.createElement("span",null,"Duplicate")),a.createElement(h.default,v({},g(E.ItemAction.DELETE),{onClick:()=>e.deleteSavedMessage(n),type:"destructive"}),a.createElement("span",null,"Delete")))))))}return(0,a.useEffect)((()=>{let t;if(e.currentComposeMessage===e.draftComposeMessage)t=r.current;else{const s=e.savedMessages.indexOf(e.currentComposeMessage);e.editTitle&&e.editTitle===e.currentComposeMessage.get("id")&&(M(s),e.editTitle=null),-1!==s&&(t=i.current.get(s))}if(t){const e=(0,n.findDOMNode)(t);e&&e.scrollIntoView({behavior:"smooth",block:"nearest"})}}),[e.currentComposeMessage]),a.createElement("div",{className:o()({"websocket-saved-messages":!0,"websocket-saved-messages--empty":f.isEmpty(e.savedMessages)})},e.savedMessagesStatus===y.WEBSOCKET_MESSAGE_STREAM_STATUS.Loading?a.createElement("div",{className:o()({"websocket-saved-messages":!0,"websocket-saved-messages--empty":!0})},a.createElement(p.default,{description:"Loading messages",size:"small"})):e.savedMessagesStatus===y.WEBSOCKET_MESSAGE_STREAM_STATUS.Error?a.createElement(g.default,{title:{text:"Couldnâ€™t load your messages."},message:{text:b<3?"Just a faulty wire. Please try again.":"We are unable to load your messages due to unforeseen circumstances. Please try again later."},secondaryAction:b<3?{label:"Retry",type:"outline",onClick:()=>{C(b+1),e.fetchSavedMessage()}}:null}):f.isEmpty(e.savedMessages)?a.createElement(g.default,{message:{text:"Add messages to reuse them during an active connection"}}):a.createElement(a.Fragment,null,e.savedMessages.map(((e,t)=>N(e,t)))))}))},7425:function(e,t,s){s.r(t),s.d(t,{default:function(){return o}});var a=s(1),n=s(2102),i=s.n(n);class o extends a.Component{getClasses(){return i()({"websocket-request-tab-content":!0,"is-hidden":!this.props.active},this.props.className)}render(){const e=this.getClasses();return a.createElement("div",{className:e},this.props.children)}}},7426:function(e,t,s){s.r(t),s.d(t,{default:function(){return n}});var a=s(1);function n(e){const t=a.Children.map(e.children,(t=>t&&a.cloneElement(t,{active:e.activeKey===t.key})));return a.createElement("div",{className:"websocket-request-tab-contents"},t)}},7408:function(e,t,s){s.r(t);var a=s(1954),n=s(1731),i=s(1970),o=s(3916),r=s(5864),l=s(12);async function c(){return(0,o.resolveStoreInstance)(r.default).onSyncAvailable({timeout:5e3})}const d=200,u={async createHistory(e,t){await c();const s=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history`,body:t}});if(!s)throw new Error("WebSocketHistoryService~createHistory: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~createHistory: Non 200 response status code",s.status);const a=l.get(s,"body.id");if(!a)throw new Error("WebSocketHistoryService~createHistory:History ID not received.");return{id:a}},async addMessagesToHistory(e,t,s){await c();const a=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history/${t}/messages`,body:s}});if(!a)throw new Error("WebSocketHistoryService~addMessagesToHistory: Response not available");if(a.status!==d)throw new Error("WebSocketHistoryService~addMessagesToHistory: Non 200 response status code")},async fetchHistoryList({workspaceId:e,nextCursor:t,limit:s=50,dir:a="desc"}){let i=`?dir=${a}`;t&&(i=`${i}&cursor=${t}`),s&&(i=`${i}&limit=${s}`),await c();const o=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"get",path:`/workspaces/${e}/history${i}`}});if(!o)throw new Error("WebSocketHistoryService~fetchHistoryList: Response not available");if(o.status!==d)throw new Error("WebSocketHistoryService~fetchHistoryList: Non 200 response status code",o.status);const{data:r,meta:u}=l.get(o,"body",{});if(!r||!u)throw new Error("WebSocketHistoryService~fetchHistoryList: Incorrect response structure.");return{data:r,meta:u}},async fetchHistoryMeta(e,t){await c();const s=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"get",path:`/workspaces/${e}/history/${t}`}});if(!s)throw new Error("WebSocketHistoryService~fetchHistoryMeta: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~fetchHistoryMeta: Non 200 response status code",s.status);return s.body},async fetchHistoryMessages(e,t){await c();const s=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"get",path:`/workspaces/${e}/history/${t}/messages`}});if(!s)throw new Error("WebSocketHistoryService~fetchHistoryMessages: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~fetchHistoryMessages: Non 200 response status code",s.status);const{messages:a}=l.get(s,"body",{});if(!a)throw new Error("WebSocketHistoryService~fetchHistoryMessages: Incorrect response structure.");return a},async deleteHistory(e,t){l.isString(t)&&(t=[t]),await c();const s=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"delete",path:`/workspaces/${e}/history`,body:{ids:t}}});if(!s)throw new Error("WebSocketHistoryService~deleteHistory: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~deleteHistory: Non 200 response status code",s.status)},async subscribeToRealtimeEvents(e){await c();const t=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history/subscribe`}});if(!t)throw new Error("WebSocketHistoryService~subscribeToRealtimeEvents: Response not available");if(t.status!==d)throw new Error("WebSocketHistoryService~subscribeToRealtimeEvents: Non 200 response status code",t.status);const{subscription:s}=t.body||{};return(0,i.getRealtimeMessagesObservable)().pipe((0,a.filter)((e=>e&&e.sub===s)))},async unsubscribeFromRealtimeEvents(e){await c();const t=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history/unsubscribe`}});if(!t)throw new Error("WebSocketHistoryService~unsubscribeFromRealtimeEvents: Response not available");if(t.status!==d)throw new Error("WebSocketHistoryService~unsubscribeFromRealtimeEvents: Non 200 response status code",t.status)}};t.default=u},7443:function(e,t,s){s.r(t),s.d(t,{default:function(){return l}});var a=s(4986),n=s(4155),i=s(7434),o=s(4946),r=s(12);class l extends i.default{didCreate({routeParams:e}){return this.id=e&&e.echid,this.setWorkbenchStatus(n.LOADING),(0,a.getViewHistoryPermission)().then((e=>{if(!e)return this.setWorkbenchStatus(o.WORKBENCH_VIEW_PERMISSION_ERROR),Promise.resolve();const t=o.SDK_MAP[this._route.split("/")[0]];if(!t)throw new Error("Failed to extract sdk from type");return t.history.fetchHistory(this.id).then((e=>{const t=e[0],s=e.slice(1,-1);return[{...t.item,id:this.id},s]})).catch((e=>{pm.logger.error("WebSocketHistoryWorkbenchController~fetchHistory",e),this.setWorkbenchStatus(n.ERROR)}))})).then((([e,t])=>{if(e&&!r.isEmpty(t))return this.setActiveModel(e.type,e,o.WEBSOCKET_MESSAGE_STREAM_STATUS.Loading,{isHistory:!0,tabId:this.getTabId()}),this.restoreRequestState(),this.setWorkbenchStatus(n.READY),this.model.onMessageStreamFetch(null,t)}))}}},7422:function(e,t,s){s.r(t),s.d(t,{canOverridePreviewHeader:function(){return p},getPreviewHeaders:function(){return u},prepareHeadersForPreview:function(){return h}});var a=s(12);const n="connection",i="upgrade",o="host",r="sec-websocket-version",l="sec-websocket-key",c="sec-websocket-extensions",d={[o]:1,[n]:2,[i]:3,[l]:4,[r]:5,[c]:6};function u(){return{[o]:{enabled:!0,key:"Host",system:!0,value:"<calculated at runtime>"},[n]:{enabled:!0,key:"Connection",system:!0,value:"Upgrade"},[i]:{enabled:!0,key:"Upgrade",system:!0,value:"websocket"},[l]:{enabled:!0,key:"Sec-WebSocket-Key",system:!0,value:"<calculated at runtime>"},[r]:{enabled:!0,key:"Sec-WebSocket-Version",system:!0,value:"13"},[c]:{enabled:!0,key:"Sec-WebSocket-Extensions",system:!0,value:"permessage-deflate; client_max_window_bits"}}}function h(e,t={}){return a.map(e,(e=>{if(!e)return;const s=a.toLower(e.key);let u={};switch(s){case r:u={header:"This header was automatically added",body:"The Sec-WebSocket-Version header field is used in the WebSocket opening handshake. It is sent from the client to the server to indicate the protocol version of the connection. This enables servers to correctly interpret the opening handshake and subsequent data being sent from the data, and close the connection if the server cannot interpret that data in a safe manner."};break;case l:u={header:"This header was automatically added",body:"The Sec-WebSocket-Key header field is used in the WebSocket opening handshake. It is sent from the client to the server to provide part of the information used by the server to prove that it received a valid WebSocket opening handshake. This helps ensure that the server does not accept connections from non-WebSocket clients (e.g., HTTP clients) that are being abused to send data to unsuspecting WebSocket servers."};break;case c:u={header:"This header was automatically added",body:"The Sec-WebSocket-Extensions header field is used in the WebSocket opening handshake. It is initially sent from the client to the server, and then subsequently sent from the server to the client, to agree on a set of protocol-level extensions to use for the duration of the connection."};break;case i:u={header:"This header was automatically added",body:"The WebSocket handshake uses the HTTP Upgrade header to change from the HTTP protocol to the WebSocket protocol."};break;case o:u={header:"This header was automatically added",body:"The Host request-header field specifies the Internet host and port number of the resource being requested, as obtained from the original URI."};break;case n:u={header:"This header was automatically added",body:"The Connection general-header field allows the sender to specify options that are desired for that particular connection."}}return a.assign({previewInfoTooltip:u,disableEdit:!0,sortOrder:d[s],warning:t[s],overridden:a.has(t,s)},e,{enableSettingToTurnOffPreviewEntity:!1,previewEntityWithHelper:null})}))}function p(e,t){if(!t)return null;return a.toLower(t)!==c}},7439:function(e,t,s){s.r(t),s.d(t,{default:function(){return y}});var a=s(1006),n=s(1491),i=s.n(n),o=s(1935),r=s(1697),l=s(5942),c=s(4992),d=s(4947),u=s(7438),h=s(7435),p=s(3952),m=s(4946),E=s(4988),g=s(7440),S=s(12),_=s(190).Buffer;class y extends h.default{constructor(e,t,s){super(m.WEBSOCKET_REQUEST_TYPE.RAW,e,t,s),this.type=m.WEBSOCKET_REQUEST_TYPE.RAW,this.messageParser={...this.messageParser,[m.WEBSOCKET_OUTGOING_MESSAGE]:g.parseIncomingOrOutgoingMessage,[m.WEBSOCKET_INCOMING_MESSAGE]:g.parseIncomingOrOutgoingMessage},this.historyEventParser={...this.historyEventParser,"sent-message":g.parseSentOrReceviedMessageEvent,"received-message":g.parseSentOrReceviedMessageEvent}}async saveMessageFromStream(e){let t;const s=S.get(e,"meta.preview.text"),a="string"==typeof s&&S.trim(s.substring(0,50))||"New message";t=ArrayBuffer.isView(e.payload)?new p.ObservableTrackedState(new u.RawComposeMessage({title:a,content:_.from(e.payload).toString("base64"),type:d.WebSocketMessageBodyType.BINARY,subtype:d.WebSocketMessageBodySubType.BASE64})):new p.ObservableTrackedState(new u.RawComposeMessage({title:a,content:e.payload,type:m.MIME_TYPE_TO_MESSAGE_BODY_TYPE_MAP[e.meta.mimeType]||d.WebSocketMessageBodyType.TEXT,subtype:null})),await this.saveMessage(t,!0)}_serializeSavedMessage(e){const t={...S.pick(e,["id","title"]),type:E.default.type,payload:S.pick(e,["content","type"])};return e.type===d.WebSocketMessageBodyType.POSTMAN_JSON&&(t.payload.type=d.WebSocketMessageBodyType.JSON),e.type===d.WebSocketMessageBodyType.BINARY&&(t.payload.subtype=e.subtype),t}_deserializeSavedMessage(e){const t={...S.pick(e,["id","title"]),...S.pick(e.payload,["content","type","subtype"])};return t.type===d.WebSocketMessageBodyType.JSON&&(t.type=d.WebSocketMessageBodyType.POSTMAN_JSON),t}async connectionSetup(){super.connectionSetup();try{this.handshakeConfiguration=await(0,c.prepareHandshakeConfiguration)({url:this.url,settings:(0,a.toJS)(this.settings),headers:(0,a.toJS)(this.headers)},{collection:this.collection})}catch(e){pm.logger.error("RawWebSocketWorkbenchModel~connectionSetup: Error in preparing handshake config",e)}}onOpen({request:e,response:t,meta:{protocol:s,extensions:n}={},time:i}){(0,a.transaction)((()=>{this.set("status",m.CONNECTED),this.set("connectionStatistics",{connectedOn:i,protocol:s,extensions:n});const a=(0,c.createMessage)(m.WEBSOCKET_CONNECTED_MESSAGE,{handshakeDetails:(0,c.prepareHandshakeDetails)(e,t)},{preview:(0,c.getMessagePreview)(m.WEBSOCKET_CONNECTED_MESSAGE,{url:S.get(this.handshakeConfiguration,"url")}),time:i,mimeType:m.APPLICATION_JSON});this.set("message",a)})),r.default.addEventV2({category:"history",action:"create",label:"websocket_connect_success",value:1,meta:{id:this.id,origin:(()=>this.isSavedRequest?"saved":S.get(this.context,"isHistory")?"history":"unsaved")()}})}onUpgrade({request:e,response:t}){(e||t)&&(t.code=`${t.statusCode} ${t.statusMessage}`,l.default.logRequest({request:e,response:t,history:{execution:{data:[{request:e,response:t}]}}}))}onMessage({message:e,meta:t,time:s}){e&&e instanceof ArrayBuffer&&(e=new Uint8Array(e));const a=(0,c.createMessage)(m.WEBSOCKET_INCOMING_MESSAGE,e,{preview:(0,c.getMessagePreview)(m.WEBSOCKET_INCOMING_MESSAGE,{message:e,mimeType:t.mimeType}),time:s,size:t.size,mimeType:t.mimeType,fileExtension:t.ext});this.set("message",a)}onReconnect({time:e}){(0,a.transaction)((()=>{this.set("status",m.RECONNECTING);const t=(0,c.createMessage)(m.WEBSOCKET_RECONNECTING_MESSAGE,null,{preview:(0,c.getMessagePreview)(m.WEBSOCKET_RECONNECTING_MESSAGE,{url:S.get(this.handshakeConfiguration,"url")}),time:e,mimeType:m.TEXT_PLAIN});this.set("message",t)}))}onEnd({code:e,reason:t,aborted:s,time:n}){(0,a.transaction)((()=>{let a;this.set("status",m.IDLE),s?a=(0,c.createMessage)(m.WEBSOCKET_ABORT_MESSAGE,null,{preview:(0,c.getMessagePreview)(m.WEBSOCKET_ABORT_MESSAGE),time:n,mimeType:m.TEXT_PLAIN}):this.handshakeError||(a=(0,c.createMessage)(m.WEBSOCKET_DISCONNECTED_MESSAGE,(0,c.getConnectionCloseInfo)(e,t),{preview:(0,c.getMessagePreview)(m.WEBSOCKET_DISCONNECTED_MESSAGE,{url:S.get(this.handshakeConfiguration,"url")}),time:n,mimeType:m.TEXT_PLAIN})),a&&this.set("message",a)})),this.createHistory(),this.connectionCleanup()}onError({error:e,request:t,response:s,time:n}){const i=e&&(e.data||e.message)||"Socket connection error. Please try again.",o=(0,c.createMessage)(m.WEBSOCKET_ERROR_MESSAGE,{error:i,handshakeDetails:(0,c.prepareHandshakeDetails)(t,s)},{preview:(0,c.getMessagePreview)(m.WEBSOCKET_ERROR_MESSAGE,{url:S.get(this.handshakeConfiguration,"url")}),time:n,mimeType:m.APPLICATION_JSON});(0,a.transaction)((()=>{this.set("message",o),this.toggleExpanded(o.id)})),r.default.addEventV2({category:"history",action:"create",label:"websocket_connect_failure",value:1,meta:{errorCode:e&&e.code||"ERR_WEBSOCKET_UNKNOWN"}}),this.handshakeError=!0}_handleEvents(e){if(!e||e.connectionId!==this.connectionId)return;const{event:t,data:s}=e,a=m.CONNECTION_EVENT_TO_HANDLER_MAP[t];a&&S.isFunction(this[a])&&(s.time=(new Date).toISOString(),this[a](s))}attachConnectionEventsListener(){pm.runtime.agent.on("ws-events",this._handleEvents.bind(this))}async connect(){this.url&&(await this.connectionSetup(),this.set("status",m.CONNECTING),pm.runtime.wsConnect(this.connectionId,this.handshakeConfiguration),o.default.promoteEditor({id:S.get(this.context,"tabId")}))}async send(){this.connectionId||this.status!==m.IDLE||(this.connect(),await new Promise((e=>{if(this.status===m.CONNECTED)return e();this.reactionDisposer=(0,a.reaction)((()=>this.status),(t=>{t===m.CONNECTED&&(this.reactionDisposer&&this.reactionDisposer(),e())}))})));const e=this.currentComposeMessage.get("type"),t=this.currentComposeMessage.get("subtype");let s=this.currentComposeMessage.get("content");try{s=await(0,c.resolveVariables)(s,this.collection)}catch(e){pm.logger.error("WebSocketWorkbenchModel~publish: Error in resolving payload",e)}if(e===d.WebSocketMessageBodyType.POSTMAN_JSON)s=i()(s,{whitespace:!1});else if(e===d.WebSocketMessageBodyType.BINARY)try{s=(0,c.parseBinaryMessage)(s,t)}catch(e){if(e instanceof SyntaxError)return void pm.toasts.error(`Can not send message: ${e.message}.`,{dedupeId:"raw-ws-send"});throw e}const n=ArrayBuffer.isView(s)?(0,c.binaryToBase64)(s):s,o=_.byteLength(s),r=m.MESSAGE_BODY_TYPE_TO_MIME_TYPE_MAP[e];pm.runtime.wsSend(this.connectionId,n,{messageType:e},(()=>{const e=(0,c.createMessage)(m.WEBSOCKET_OUTGOING_MESSAGE,s,{preview:(0,c.getMessagePreview)(m.WEBSOCKET_OUTGOING_MESSAGE,{message:s,mimeType:r}),time:(new Date).toISOString(),size:o,mimeType:r});this.set("message",e)}))}disconnect(e=!1){this.connectionId&&(this.set("status",m.DISCONNECTING),pm.runtime.wsDisconnect(this.connectionId),e&&this.onEnd({code:1006}))}_deserializeMessages(e){return(0,c.deserializeMessages)(this.url,e)}}y.editableAttributes={url:{defaultsTo:""},headers:{defaultsTo:[]},queryParams:{defaultsTo:[]},settings:{defaultsTo:{}}},y.MessageClass=u.RawComposeMessage,y.keysForFilterByType=["type"],y.keysForFilterByKeyword=["payload","meta.preview"]},7427:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(2119),o=s.n(i),r=s(3060),l=s(2872),c=s(2792),d=s(4386),u=s(3081),h=s(4642),p=s(7413),m=s(4946),E=s(4992),g=s(4947),S=s(1821),_=s(12);const y={[g.WebSocketMessageBodyType.TEXT]:m.USER_FRIENDLY_LANGUAGE_NAME[g.WebSocketMessageBodyType.TEXT],[g.WebSocketMessageBodyType.POSTMAN_JSON]:m.USER_FRIENDLY_LANGUAGE_NAME[g.WebSocketMessageBodyType.POSTMAN_JSON],[g.WebSocketMessageBodyType.XML]:m.USER_FRIENDLY_LANGUAGE_NAME[g.WebSocketMessageBodyType.XML],[g.WebSocketMessageBodyType.HTML]:m.USER_FRIENDLY_LANGUAGE_NAME[g.WebSocketMessageBodyType.HTML],[g.WebSocketMessageBodyType.BINARY]:m.USER_FRIENDLY_LANGUAGE_NAME[g.WebSocketMessageBodyType.BINARY]},T={[g.WebSocketMessageBodySubType.BASE64]:m.USER_FRIENDLY_LANGUAGE_NAME[g.WebSocketMessageBodySubType.BASE64],[g.WebSocketMessageBodySubType.HEX]:m.USER_FRIENDLY_LANGUAGE_NAME[g.WebSocketMessageBodySubType.HEX]},f=[g.WebSocketMessageBodyType.TEXT,g.WebSocketMessageBodyType.BINARY],v={submit:"mod+enter"},b=(0,S.c)(class extends a.Component{constructor(e){super(e),this.handleBeautify=this.handleBeautify.bind(this),this.handleTypeChange=this.handleTypeChange.bind(this),this.handleSubTypeChange=this.handleSubTypeChange.bind(this),this.handleMessageChange=this.handleMessageChange.bind(this),this.handleSend=this.handleSend.bind(this)}getKeyMapHandlers(){return{submit:this.handleSend}}showMessageSubTypes(e){return e===g.WebSocketMessageBodyType.BINARY}handleTypeChange(e,t){const s={type:e};this.showMessageSubTypes(e)?null==t&&_.assign(s,{subtype:g.WebSocketMessageBodySubType.BASE64}):_.assign(s,{subtype:null}),this.props.model.currentComposeMessage.set(s)}handleSubTypeChange(e){this.props.model.currentComposeMessage.set({subtype:e})}handleMessageChange(e){this.props.model.currentComposeMessage.set({content:e})}handleBeautify(){this.editorRef&&this.editorRef.beautifyContent&&this.editorRef.beautifyContent()}handleSend(){this.isSendDisabled||this.props.model.send&&this.props.model.send()}render(){let e;const{model:t}=this.props,{isDisabled:s,reason:n}=(0,E.isConnectDisabled)(t.type,t.url),i=t.currentComposeMessage.get("content"),o=t.currentComposeMessage.get("type"),g=t.currentComposeMessage.get("subtype");this.isSendDisabled=s&&(e=n)||t.status!==m.CONNECTED&&t.status!==m.IDLE;const S="OSX"===pm.app.get("platform"),b=e||(S?"âŒ˜ â†µ":"Ctrl + Enter"),C=this.showMessageSubTypes(o);return a.createElement("div",{className:"raw-websocket-compose"},a.createElement(c.default,{keyMap:v,handlers:this.getKeyMapHandlers()},a.createElement("div",{className:"raw-websocket-compose__editor","data-testid":"raw-websocket-compose-editor"},a.createElement(u.default,{fontSize:12,placeholder:"Compose message",onChange:this.handleMessageChange,language:C?g:o,value:i,ref:e=>{this.editorRef=e},codeCompletionProviders:[{provider:h.default.bind(this)}]}))),a.createElement("div",{className:"raw-websocket-compose__footer"},a.createElement("div",{className:"raw-websocket-compose__footer__left"},a.createElement(p.default,{languageMap:y,activeLanguage:o,onChange:e=>this.handleTypeChange(e,g),className:"raw-websocket-compose__footer__left__lang-selector"}),C&&a.createElement(p.default,{languageMap:T,activeLanguage:g,onChange:this.handleSubTypeChange}),!_.includes(f,o)&&a.createElement(r.default,{onClick:this.handleBeautify,type:"tertiary",icon:"icon-action-pretty-stroke",tooltip:"Beautify"})),a.createElement(l.default,{alignItems:"center",wrap:"wrap",gap:"spacing-s"},a.createElement(d.Button,{variant:t.status===m.CONNECTED?"cta":"secondary",tooltip:b,onClick:this.handleSend,isDisabled:this.isSendDisabled,"data-testid":"ws-raw-sendMessage-button"},"Send"))))}},[n.observer]);t.default=b,b.contextTypes={variablesCache:o().object}},7402:function(e,t,s){s.r(t),s.d(t,{default:function(){return l}});var a=s(1),n=s(4564),i=s(7403),o=s(7411),r=s(12);class l extends a.Component{constructor(e){super(e),this.getListItem=this.getListItem.bind(this),this.handleMessageSelect=this.handleMessageSelect.bind(this),this.handleMediaSave=this.handleMediaSave.bind(this),this.handleListItemExpandAndCollapse=this.handleListItemExpandAndCollapse.bind(this)}getListItem(e,t){const{model:s}=this.props;return a.createElement(o.default,{key:t.id,index:e,message:t,isSelected:s.selectedMessageSet.get(t.id),numberOfSelectedMessages:s.selectedMessageSet.size,cachedExpandedState:s.expandedMessageSet.get(t.id),mediaFilePath:s.messageMediaFilePaths.get(t.id),onMediaSave:this.handleMediaSave,toggleExpanded:this.handleListItemExpandAndCollapse,toggleMessageSelect:this.handleMessageSelect,saveMessage:s.saveMessageFromStream.bind(s),saveMessagesChecks:{isSavedRequest:s.isSavedRequest,isOnline:s.messageSDK.isOnline(),hasPermission:s.messageSDK.hasPermission(null,n.ItemAction.CREATE,!1,s.id)}})}handleMediaSave(e,t){this.props.model.saveMediaFilePath(e,t)}handleListItemExpandAndCollapse(e,t,s){this.props.model.toggleExpanded&&this.props.model.toggleExpanded(t,s),r.isNil(s)&&this.streamRef&&this.streamRef.handleResetHeight(e)}handleMessageSelect(e){this.props.model&&this.props.model.toggleMessageSelect(e)}render(){return a.createElement(i.default,{ref:e=>{this.streamRef=e},model:this.props.model,renderListItem:this.getListItem})}}},7411:function(e,t,s){s.r(t);var a=s(1),n=s(2083),i=s.n(n),o=s(2098),r=s(1006),l=s(2102),c=s.n(l),d=s(2802),u=s(3057),h=s(3060),p=s(2810),m=s(3825),E=s(2112),g=s(1735),S=s(3071),_=s(3941),y=s(3077),T=s(3049),f=s(4992),v=s(4946),b=s(7412),C=s(4947),M=s(1821),O=s(12);const A=(0,M.c)(class extends a.Component{constructor(e){super(e),this.state={isHovered:!1,forceEllipsifyPreview:!1},this.handleCopy=this.handleCopy.bind(this),this.handleSave=this.handleSave.bind(this),this.toggleSelect=this.toggleSelect.bind(this),this.toggleExpanded=this.toggleExpanded.bind(this),this.stopItemExpand=this.stopItemExpand.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.handleMediaSave=this.handleMediaSave.bind(this),this.updateExpandedCachedState=this.updateExpandedCachedState.bind(this),this.isPayloadEmpty=this.isPayloadEmpty.bind(this)}componentDidMount(){this.shouldForceEllipsifyPreview()}getClasses(e){return c()({"websocket-stream-item":!0,"server-message":e===v.WEBSOCKET_INCOMING_MESSAGE,"client-message":e===v.WEBSOCKET_OUTGOING_MESSAGE,"no-body":this.isPayloadEmpty()})}getDataTestId(e){switch(e){case v.WEBSOCKET_INCOMING_MESSAGE:return"ws-raw-server-message";case v.WEBSOCKET_OUTGOING_MESSAGE:return"ws-raw-client-message"}}getPreviewMessageClasses(){return c()({"websocket-stream-item__header__left-section__message":!0,"add-ellipsis":this.state.forceEllipsifyPreview})}isPayloadEmpty(){return O.isNil(O.get(this.props.message,"payload"))}shouldForceEllipsifyPreview(){const e=this.previewRef;!O.get(this.props.message,"meta.preview.truncated")||!e||e.clientWidth<e.scrollWidth||this.setState({forceEllipsifyPreview:!0})}showCheckBox(e){return(e===v.WEBSOCKET_OUTGOING_MESSAGE||e===v.WEBSOCKET_INCOMING_MESSAGE)&&(this.state.isHovered||this.props.isSelected||this.props.numberOfSelectedMessages>0)}stopItemExpand(e){e&&e.stopPropagation()}toggleExpanded(){if(this.isPayloadEmpty())return;const{id:e}=this.props.message||{};this.props.toggleExpanded&&this.props.toggleExpanded(this.props.index,e,null)}updateExpandedCachedState(e){if(this.isPayloadEmpty())return;const{id:t}=this.props.message||{};this.props.toggleExpanded&&this.props.toggleExpanded(this.props.index,t,e)}toggleSelect(){const{id:e}=this.props.message||{};this.props.toggleMessageSelect&&this.props.toggleMessageSelect(e)}handleMediaSave(e){this.props.onMediaSave&&this.props.onMediaSave(this.props.message.id,e)}handleCopy(){const e=O.get(this.props.message,"payload");S.default.copy(e),pm.toasts.success("Copied to clipboard",{dedupeId:"message-copied-message"})}handleSave(){this.props.saveMessage&&(this.props.saveMessage((0,r.toJS)(this.props.message)),pm.toasts.success("Message saved",{dedupeId:"message-saved-message"}))}handleMouseEnter(){this.setState({isHovered:!0})}handleMouseLeave(){this.setState({isHovered:!1})}renderObjectInspector({error:e,handshakeDetails:t}){return a.createElement("div",{className:c()({"websocket-stream-item__body__obj-inspector":!0,"no-details":O.isNil(t)})},e&&a.createElement("div",{className:"websocket-stream-item__body__obj-inspector__error"},a.createElement(d.default,{type:"strong"},"Error:"),a.createElement("span",null," "),a.createElement(d.default,{type:"body-medium",color:"content-color-primary"},e)),t&&a.createElement(a.Fragment,null,a.createElement(u.default,{type:"h6",text:"Handshake Details",color:"content-color-secondary"}),a.createElement(y.default,{data:t})))}renderText(e){const{code:t,name:s,description:n}=e||{};return a.createElement("div",{className:"websocket-stream-item__body__plain-text",title:n},a.createElement(d.default,{type:"strong"},`${t} ${s}:`),a.createElement("span",null," "),a.createElement(d.default,{type:"body-medium",color:"content-color-secondary",className:"websocket-stream-item__body__plain-text__description"},n))}renderBody(){const{type:e,meta:t,payload:s}=this.props.message||{};if(this.isPayloadEmpty())return null;let n;switch(e){case v.WEBSOCKET_OUTGOING_MESSAGE:case v.WEBSOCKET_INCOMING_MESSAGE:{const e=v.MIME_TYPE_TO_MESSAGE_BODY_TYPE_MAP[t.mimeType],i={activeLanguage:e||C.WebSocketMessageBodyType.TEXT,lineWrap:!1,hexMode:!1};e===C.WebSocketMessageBodyType.HEXDUMP&&O.assign(i,{activeLanguage:null,hexMode:!0}),n=a.createElement("div",{className:"websocket-stream-item__body__message-body-viewer"},a.createElement(b.default,{message:s,mimeType:t.mimeType,mediaFilePath:this.props.mediaFilePath,fileExtension:t.fileExtension,onMediaSave:this.handleMediaSave,cachedState:O.assign(i,this.props.cachedExpandedState),updateState:this.updateExpandedCachedState}));break}case v.WEBSOCKET_CONNECTED_MESSAGE:case v.WEBSOCKET_ERROR_MESSAGE:n=this.renderObjectInspector(s);break;case v.WEBSOCKET_DISCONNECTED_MESSAGE:default:n=this.renderText(s)}return a.createElement("div",{className:"websocket-stream-item__body"},n)}renderHeaderRightSection(e,t={},s){const{time:n,size:o,mimeType:r}=t,l=i()(n).format("HH:mm:ss"),{isSavedRequest:c,hasPermission:u}=this.props.saveMessagesChecks||{},m=this.isPayloadEmpty()?null:a.createElement(E.default,{name:this.props.cachedExpandedState?"icon-direction-up":"icon-direction-down",color:"content-color-primary",size:"large"});let S=null;const y=l?a.createElement("div",{className:"websocket-stream-item__header__right-section__time"},a.createElement(d.default,{type:"body-medium",color:"content-color-secondary"},l)):null;if(!this.state.isHovered||e!==v.WEBSOCKET_OUTGOING_MESSAGE&&e!==v.WEBSOCKET_INCOMING_MESSAGE)S=y;else{const e=!v.WEBSOCKET_MESSAGE_READABLE.has(r)||this.isPayloadEmpty()||!s;S=a.createElement(a.Fragment,null,a.createElement("div",{className:"websocket-stream-item__header__right-section__quick-actions",onClick:this.stopItemExpand},a.createElement(h.default,{onClick:this.handleCopy,type:"tertiary",icon:"icon-action-copy-stroke",isDisabled:e,tooltip:a.createElement(p.default,{content:e?"Can't copy this message":"Copy message",placement:"bottom"})}),a.createElement(h.default,{onClick:this.handleSave,type:"tertiary",icon:"icon-action-save-stroke",isDisabled:!u||!c,tooltip:a.createElement(p.default,{content:c?u?"Save message":T.DISABLED_TOOLTIP_NO_PERMISSION:"Save this request to perform this action.",placement:"bottom"})}),a.createElement(_.default,{tooltipPlacement:"bottom-left",iconSize:"large",tooltip:a.createElement("div",{className:"websocket-stream-info-tooltip"},a.createElement(d.default,{type:"body-medium",color:"content-color-primary"},`Size: ${g.default.formatSize(o)}`),a.createElement(d.default,{type:"body-medium",color:"content-color-primary"},`Time: ${l}`),a.createElement(d.default,{type:"body-medium",color:"content-color-primary"},`MIME Type: ${r}`))})),y)}return a.createElement("div",{className:"websocket-stream-item__header__right-section"},S,m)}renderHeader(){const{type:e,meta:t,payload:s}=this.props.message||{},n=v.MESSAGE_ICON_MAP[e]||v.MESSAGE_ICON_MAP.default||{},i=O.isFunction(n)?n((0,f.isNormalConnectionClose)(O.get(s,"code"))):n,{name:o,color:r,size:l}=i||{};let u;return t&&(u=O.isString(t.preview)?t.preview:O.get(t.preview,"text")),a.createElement("div",{className:c()({"websocket-stream-item__header":!0,"is-hovered":this.state.isHovered,"is-selected":this.props.isSelected}),onClick:this.toggleExpanded,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},a.createElement("div",{className:"websocket-stream-item__header__left-section",ref:e=>{this.previewRef=e}},this.showCheckBox(e)&&a.createElement("div",{className:"websocket-stream-item__header__left-section__checkbox",onClick:this.stopItemExpand},a.createElement(m.default,{isChecked:this.props.isSelected,onChange:this.toggleSelect,isDisabled:!this.props.isSelected&&2===this.props.numberOfSelectedMessages})),o&&r&&a.createElement("div",{className:"websocket-stream-item__header__left-section__type-icon"},a.createElement(E.default,{name:o,color:r,size:l})),a.createElement(d.default,{type:"body-medium",className:this.getPreviewMessageClasses(e),color:t.preview.placeholder?"content-color-secondary":"content-color-primary"},u)),this.renderHeaderRightSection(e,t,s))}render(){const{type:e}=this.props.message||{};return a.createElement("div",{className:this.getClasses(e),"data-testid":this.getDataTestId(e)},this.renderHeader(),Boolean(this.props.cachedExpandedState)&&this.renderBody())}},[o.observer]);t.default=A},7437:function(e,t,s){s.r(t),s.d(t,{default:function(){return I}});var a,n,i=s(9),o=s.n(i),r=s(1006),l=s(1491),c=s.n(l),d=s(1935),u=s(1697),h=s(4947),p=s(4992),m=s(4945),E=s(4946),g=s(7435),S=s(7438),_=s(3952),y=s(4994),T=s(4991),f=s(1821),v=s(12),b=s(190).Buffer,C=0;function M(e){return"__private_"+C+++"_"+e}const O=/^#[a-fA-F0-9]{6}$/;var A=M("eventColorMap");class N{constructor(){Object.defineProperty(this,A,{writable:!0,value:void(0,f.i)(this,"eventColorMap")})}populate(e){v.forEach(e,(({eventName:e,eventColor:t})=>{var s;s=t,O.test(s)?this.eventColorMap.set(e,t):this.getColor(e)}))}has(e){return this.eventColorMap.has(e)}setColor(e,t){if(!e||!t)return pm.logger.error("EventsCache~setColor: Event name and color are mandatory parameters");this.eventColorMap.set(e,t)}getColor(e){if(!v.isNil(e))return this.has(e)||this.setColor(e,y.EVENT_COLOR_CODE_SET[this.eventColorMap.size%y.EVENT_COLOR_CODE_SET.length]),this.eventColorMap.get(e)}get events(){return[...this.eventColorMap.keys()]}}a=N,(0,f.g)(a.prototype,"eventColorMap",[r.observable],(function(){return r.observable.map([])})),(0,f.n)(a.prototype,"populate",[r.action]),(0,f.n)(a.prototype,"setColor",[r.action]);class I extends g.default{constructor(e,t,s){super(E.WEBSOCKET_REQUEST_TYPE.SOCKETIO,e,t,s),this.type=E.WEBSOCKET_REQUEST_TYPE.SOCKETIO,this.eventsCache=new N,this.historyEventToMessageType={...this.historyEventToMessageType,"subscribe-event":y.SOCKETIO_SUBSCRIBED_MESSAGE,"unsubscribe-even":y.SOCKETIO_UNSUBSCRIBED_MESSAGE},this.messageToHistoryEventType={...this.messageToHistoryEventType,[y.SOCKETIO_SUBSCRIBED_MESSAGE]:"subscribe-event",[y.SOCKETIO_UNSUBSCRIBED_MESSAGE]:"unsubscribe-event"},this.messageParser={...this.messageParser,[E.WEBSOCKET_OUTGOING_MESSAGE]:m.parseIncomingOrOutgoingMessage,[E.WEBSOCKET_INCOMING_MESSAGE]:m.parseIncomingOrOutgoingMessage,[y.SOCKETIO_SUBSCRIBED_MESSAGE]:m.parseSubscribedOrUnsubscribedMessage,[y.SOCKETIO_UNSUBSCRIBED_MESSAGE]:m.parseSubscribedOrUnsubscribedMessage},this.historyEventParser={...this.historyEventParser,"sent-message":m.parseSentOrReceviedMessageEvent,"received-message":m.parseSentOrReceviedMessageEvent,"subscribe-event":m.parseSubscribedOrUnsubscribedEvent,"unsubscribe-event":m.parseSubscribedOrUnsubscribedEvent}}set events(e){this._trackedRequest.set({events:e})}get events(){return this._trackedRequest.get("events")}getRequestForView(e){const t=super.getRequestForView(e);if(this.context.isHistory){const s=v.get(e,"channels");v.isArray(s)&&(t.events=s)}return t}getRequestForStorage(){const e=super.getRequestForStorage();return v.merge(e,{payload:{events:(0,r.toJS)(this.events,{recurseEverything:!0})}})}addArgument(e){const t=this.currentComposeMessage.get("args"),s=t.length;this.currentComposeMessage.set({args:t.concat(new S.WebSocketComposeMessage)}),v.isFunction(e)&&e(s)}updateArgument(e,t){const s=this.currentComposeMessage.get("args").slice();s[e]&&(s[e]=new S.WebSocketComposeMessage({...s[e],...t}),this.currentComposeMessage.set({args:s}))}deleteArgument(e){const t=this.currentComposeMessage.get("args").slice();!t[e]||t.length<2||(t.splice(e,1),this.currentComposeMessage.set({args:t}))}toggleAcknowledgement(){const e=!this.currentComposeMessage.get("acknowledgement");this.currentComposeMessage.set({acknowledgement:e})}updateEventName(e){this.currentComposeMessage.set({eventName:e})}async saveMessageFromStream(e){const t=v.get(e,"meta.preview.text"),s="string"==typeof t&&v.trim(t.substring(0,50))||"New message",a=new _.ObservableTrackedState(new S.SocketIOComposeMessage({title:s,eventName:e.meta.eventName,acknowledgement:!1,args:e.payload.map((e=>ArrayBuffer.isView(e.value)?{content:b.from(e.value).toString("base64"),type:h.WebSocketMessageBodyType.BINARY,subtype:h.WebSocketMessageBodySubType.BASE64}:{content:e.value,type:E.MIME_TYPE_TO_MESSAGE_BODY_TYPE_MAP[e.meta.mimeType]||h.WebSocketMessageBodyType.TEXT,subtype:null}))}));await this.saveMessage(a,!0)}_serializeSavedMessage(e){const t={...v.pick(e,["id","title"]),type:T.default.type,payload:v.pick(e,["eventName","acknowledgement"])};return t.payload.args=v.map(e.args,(({content:e,type:t,subtype:s})=>{const a={content:e,type:t};return a.type===h.WebSocketMessageBodyType.POSTMAN_JSON&&(a.type=h.WebSocketMessageBodyType.JSON),a.type===h.WebSocketMessageBodyType.BINARY&&(a.subtype=s),a})),t}_deserializeSavedMessage(e){const t={...v.pick(e,["id","title"]),...v.pick(e.payload,["eventName","acknowledgement"])};return t.args=v.map(v.get(e,"payload.args"),(({content:e,type:t,subtype:s})=>{const a={content:e,type:t,subtype:s};return a.type===h.WebSocketMessageBodyType.JSON&&(a.type=h.WebSocketMessageBodyType.POSTMAN_JSON),a})),t}saveMediaFilePath(e,t,s){if(!e||!t)return;const a=this.messageMediaFilePaths.get(e)||{};v.isNil(a)?this.messageMediaFilePaths.set(e,{[t]:s}):this.messageMediaFilePaths.set(e,v.assign(a,{[t]:s}))}toggleExpanded(e,t){if(!this.expandedMessageSet.has(e))return this.expandedMessageSet.set(e,{});if(v.isNil(t))return this.expandedMessageSet.delete(e);const s=this.expandedMessageSet.get(e);v.assign(s,t)}get activeEventsCount(){return(0,m.sanitizeEvents)(this.events).length}onConnect({request:e,response:t,time:s}){(0,r.transaction)((()=>{this.set("status",E.CONNECTED),this.set("connectionStatistics",{connectedOn:s}),this.set("message",{id:o()(),type:E.WEBSOCKET_CONNECTED_MESSAGE,payload:{handshakeDetails:(0,p.prepareHandshakeDetails)(e,t)},meta:{preview:(0,p.getMessagePreview)(E.WEBSOCKET_CONNECTED_MESSAGE,{url:v.get(this.handshakeConfiguration,"url")}),time:s,mimeType:E.APPLICATION_JSON}});const a=this.handshakeConfiguration.listeners;a.forEach((e=>{const t={id:o()(),type:y.SOCKETIO_SUBSCRIBED_MESSAGE,payload:null,meta:{eventName:e,preview:(0,p.getMessagePreview)(y.SOCKETIO_SUBSCRIBED_MESSAGE),time:(new Date).toISOString(),mimeType:E.TEXT_PLAIN}};this.set("message",t)})),0===a.length&&this.set("message",{id:o()(),type:y.SOCKETIO_NO_LISTENER_MESSAGE,removeFromHistory:!0,meta:{preview:(0,p.getMessagePreview)(y.SOCKETIO_NO_LISTENER_MESSAGE),time:(new Date).toISOString()}})})),u.default.addEventV2({category:"history",action:"create",label:"socketio_connect_success",value:1,meta:{id:this.id,eventsCount:v.size(this.events),origin:(()=>this.isSavedRequest?"saved":v.get(this.context,"isHistory")?"history":"unsaved")()}})}onMessage({message:e,meta:t,time:s}){const a=v.map(e,(({value:e,mimeType:t,ext:s},a)=>({id:o()(),value:e instanceof ArrayBuffer?new Uint8Array(e):e,name:(0,m.getArgName)(a),meta:{mimeType:t,fileExtension:s}})));(0,r.transaction)((()=>{const e={id:o()(),type:E.WEBSOCKET_INCOMING_MESSAGE,payload:a,meta:{preview:(0,p.getMessagePreview)(E.WEBSOCKET_INCOMING_MESSAGE,{message:v.get(a,[0,"value"]),mimeType:v.get(a,[0,"meta","mimeType"])}),time:s,eventName:t.event}};this.set("message",e)}))}onError({request:e,response:t,error:s,time:a}){const n=s&&(s.data||s.message)||"Socket connection error. Please try again.",i={id:o()(),type:E.WEBSOCKET_ERROR_MESSAGE,payload:{error:n,handshakeDetails:(0,p.prepareHandshakeDetails)(e,t)},meta:{preview:(0,p.getMessagePreview)(E.WEBSOCKET_ERROR_MESSAGE,{url:v.get(this.handshakeConfiguration,"url")}),time:a,mimeType:E.APPLICATION_JSON}};(0,r.transaction)((()=>{this.set("message",i),this.toggleExpanded(i.id)})),u.default.addEventV2({category:"history",action:"create",label:"socketio_connect_failure",value:1,meta:{errorMessage:n}}),this.handshakeError=!0}onReconnect({time:e}){(0,r.transaction)((()=>{this.set("status",E.RECONNECTING),this.set("message",{id:o()(),type:E.WEBSOCKET_RECONNECTING_MESSAGE,meta:{preview:(0,p.getMessagePreview)(E.WEBSOCKET_RECONNECTING_MESSAGE,{url:v.get(this.handshakeConfiguration,"url")}),time:e,mimeType:E.TEXT_PLAIN}})}))}onEnd({reason:e,aborted:t,time:s}){(0,r.transaction)((()=>{let a;this.set("status",E.IDLE),t?a={id:o()(),type:E.WEBSOCKET_ABORT_MESSAGE,payload:null,meta:{preview:(0,p.getMessagePreview)(E.WEBSOCKET_ABORT_MESSAGE),time:s,mimeType:E.TEXT_PLAIN}}:this.handshakeError||(a={id:o()(),type:E.WEBSOCKET_DISCONNECTED_MESSAGE,payload:(0,m.getConnectionCloseInfo)(e),meta:{preview:(0,p.getMessagePreview)(E.WEBSOCKET_DISCONNECTED_MESSAGE,{url:v.get(this.handshakeConfiguration,"url")}),time:s,mimeType:E.TEXT_PLAIN}}),a&&this.set("message",a)})),this.createHistory(),this.connectionCleanup()}_handleEvents(e){if(!e||e.connectionId!==this.connectionId)return;const{event:t,data:s}=e,a=y.CONNECTION_EVENT_TO_HANDLER_MAP[t];a&&v.isFunction(this[a])&&(s.time=(new Date).toISOString(),this[a](s))}attachConnectionEventsListener(){pm.runtime.agent.on("socketIO-events",this._handleEvents.bind(this))}async connectionSetup(){super.connectionSetup();try{this.handshakeConfiguration=await(0,m.prepareHandshakeConfiguration)({url:this.url,settings:(0,r.toJS)(this.settings),headers:(0,r.toJS)(this.headers),listeners:this.events},{collection:this.collection})}catch(e){pm.logger.error("SocketIOWorkbenchModel~connectionSetup: Error in preparing handshake config",e)}}async connect(){this.url&&(await this.connectionSetup(),this.set("status",E.CONNECTING),pm.runtime.socketIOConnect(this.connectionId,this.handshakeConfiguration),d.default.promoteEditor({id:v.get(this.context,"tabId")}))}async publish(){this.connectionId||this.status!==E.IDLE||(this.connect(),await new Promise((e=>{if(this.status===E.CONNECTED)return e();this.reactionDisposer=(0,r.reaction)((()=>this.status),(t=>{t===E.CONNECTED&&(this.reactionDisposer&&this.reactionDisposer(),e())}))})));let e=v.cloneDeep(this.currentComposeMessage.get("args"));try{e=await(0,p.resolveVariables)(e,this.collection)}catch(e){pm.logger.error("SocketIOWorkbenchModel~publish: Error in resolving payload",e)}for(let t=0;t<e.length;t++){const s=e[t];if(s.type===h.WebSocketMessageBodyType.POSTMAN_JSON){s.content=c()(s.content,{whitespace:!1});try{JSON.parse(s.content)}catch(e){return void pm.toasts.error("Can not send message: Invalid JSON.",{dedupeId:"socketIO-publish"})}}else if(s.type===h.WebSocketMessageBodyType.BINARY)try{s.content=(0,p.parseBinaryMessage)(s.content,s.subtype)}catch(e){if(e instanceof SyntaxError)return void pm.toasts.error(`Can not send message: ${e.message}.`,{dedupeId:"socketIO-send"});throw e}s.mimeType=E.MESSAGE_BODY_TYPE_TO_MIME_TYPE_MAP[s.type]}const t=v.map(e,(e=>({value:ArrayBuffer.isView(e.content)?(0,p.binaryToBase64)(e.content):e.content,mimeType:e.mimeType}))),s=this.currentComposeMessage.get("eventName")||"message",a=this.currentComposeMessage.get("acknowledgement");pm.runtime.socketIOPublish(this.connectionId,s,t,{acknowledgement:a},(()=>{const t={id:o()(),type:E.WEBSOCKET_OUTGOING_MESSAGE,payload:e.map(((e,t)=>({id:o()(),name:(0,m.getArgName)(t),value:e.content,meta:{mimeType:e.mimeType}}))),meta:{preview:(0,p.getMessagePreview)(E.WEBSOCKET_OUTGOING_MESSAGE,{message:v.get(e,[0,"content"]),mimeType:v.get(e,[0,"mimeType"])}),time:(new Date).toISOString(),eventName:s}};this.set("message",t)}))}_subscribe(e){this.status===E.CONNECTED&&pm.runtime.socketIOSubscribe(this.connectionId,e,(()=>{const t={id:o()(),type:y.SOCKETIO_SUBSCRIBED_MESSAGE,payload:null,meta:{eventName:e,preview:(0,p.getMessagePreview)(y.SOCKETIO_SUBSCRIBED_MESSAGE),time:(new Date).toISOString(),mimeType:E.TEXT_PLAIN}};this.set("message",t)}))}subscribe(e){if(!e)return;const t=this.events.findIndex((t=>t.name===e)),s=-1!==t&&this.events[t];if(null!=s&&s.subscribeOnConnect)return;this._subscribe(e);const a=(0,r.toJS)(this.events);a[t].subscribeOnConnect=!0,this.set("events",a)}_unsubscribe(e){this.status===E.CONNECTED&&pm.runtime.socketIOUnsubscribe(this.connectionId,e,(()=>{const t={id:o()(),type:y.SOCKETIO_UNSUBSCRIBED_MESSAGE,payload:null,meta:{eventName:e,preview:(0,p.getMessagePreview)(y.SOCKETIO_UNSUBSCRIBED_MESSAGE),time:(new Date).toISOString(),mimeType:E.TEXT_PLAIN}};this.set("message",t)}))}unsubscribe(e,t=-1){if(!e)return;let s=-1;s=-1!==t?t:this.events.findIndex((t=>t.name===e));const a=-1!==s&&this.events[s];if(null==a||!a.subscribeOnConnect)return;this._unsubscribe(e);const n=(0,r.toJS)(this.events);n[s].subscribeOnConnect=!1,this.set("events",n)}toggleSubscription(e,t){t?this.subscribe(e):this.unsubscribe(e)}disconnect(e=!1){this.connectionId&&(this.set("status",E.DISCONNECTING),e&&this.onEnd({reason:"transport close"}),pm.runtime.socketIODisconnect(this.connectionId))}_deserializeMessages(e){return(0,m.deserializeMessages)(this.url,e)}}n=I,I.editableAttributes={url:{defaultsTo:""},headers:{defaultsTo:[]},queryParams:{defaultsTo:[]},settings:{defaultsTo:{}},events:{defaultsTo:[]}},I.MessageClass=S.SocketIOComposeMessage,I.keysForFilterByType=["type"],I.keysForFilterByKeyword=["meta.eventName","payload.value","meta.preview"],(0,f.n)(n.prototype,"events",[r.computed]),(0,f.n)(n.prototype,"addArgument",[r.action]),(0,f.n)(n.prototype,"updateArgument",[r.action]),(0,f.n)(n.prototype,"deleteArgument",[r.action]),(0,f.n)(n.prototype,"toggleAcknowledgement",[r.action]),(0,f.n)(n.prototype,"updateEventName",[r.action]),(0,f.n)(n.prototype,"saveMediaFilePath",[r.action]),(0,f.n)(n.prototype,"toggleExpanded",[r.action]),(0,f.n)(n.prototype,"activeEventsCount",[r.computed]),(0,f.n)(n.prototype,"_subscribe",[r.action]),(0,f.n)(n.prototype,"subscribe",[r.action]),(0,f.n)(n.prototype,"_unsubscribe",[r.action]),(0,f.n)(n.prototype,"unsubscribe",[r.action])},7416:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(2102),o=s.n(i),r=s(2802),l=s(2112),c=s(4945),d=s(1821),u=s(12);const h=e=>{const t=(0,a.useRef)(null),s=(0,a.useRef)(null),[n,i]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{e.readOnly||s&&s.current&&s.current.scrollIntoView()}),[]),a.createElement("div",{className:o()("args-nav-bar-item",{"is-active":e.isActive}),onClick:()=>e.onSelect(e.index),onMouseOver:()=>{t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{i(!0)}),200)},onMouseOut:()=>{t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{i(!1)}),200)},ref:s},a.createElement(r.default,{type:"body-small",color:e.isActive?"content-color-primary":"content-color-secondary",isTruncated:!0},e.isActive?a.createElement(r.default,{type:"strong"},e.name):e.name),!e.readOnly&&!e.isLast&&n&&a.createElement("div",{className:"args-nav-bar-item__close",onClick:t=>{t&&t.stopPropagation(),e.onClose(e.index)}},a.createElement(l.default,{name:"icon-state-fail",color:"content-color-primary"})))},p=e=>a.createElement("div",{className:"args-nav-bar"},u.map(e.args,((t,s)=>a.createElement(h,{key:s,index:s,name:(0,c.getArgName)(s),isActive:e.activeArg===s,onSelect:e.onSelect,onClose:e.onClose,isLast:1===e.args.length,readOnly:e.readOnly})))),m=(0,d.c)(class extends a.Component{constructor(e){super(e),this.onArgClose=this.onArgClose.bind(this)}componentDidMount(){this.props.onActiveArgChange&&this.props.onActiveArgChange(this.props.activeArg)}onArgClose(e){if(this.props.readOnly)return;const{args:t}=this.props;if(!(t&&t.length<=1)){if(e===this.props.activeArg){const t=e<=0?0:e-1;this.props.onActiveArgChange&&this.props.onActiveArgChange(t)}this.props.onArgClose(e)}}render(){return a.createElement("div",{className:o()("multi-arg-message-editor",this.props.className)},this.props.args.length>=2&&a.createElement(p,{activeArg:this.props.activeArg,args:this.props.args,onSelect:this.props.onActiveArgChange,onClose:this.onArgClose,readOnly:this.props.readOnly}),this.props.renderMessageContent(this.props.activeArg))}},[n.observer]);t.default=m},7428:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(2119),o=s.n(i),r=s(3060),l=s(3825),c=s(2792),d=s(2589),u=s(4386),h=s(2126),p=s(3081),m=s(4642),E=s(7413),g=s(7416),S=s(4946),_=s(4992),y=s(4947),T=s(1821),f=s(12),v=s(33);const b={[y.WebSocketMessageBodyType.TEXT]:S.USER_FRIENDLY_LANGUAGE_NAME[y.WebSocketMessageBodyType.TEXT],[y.WebSocketMessageBodyType.POSTMAN_JSON]:S.USER_FRIENDLY_LANGUAGE_NAME[y.WebSocketMessageBodyType.POSTMAN_JSON],[y.WebSocketMessageBodyType.BINARY]:S.USER_FRIENDLY_LANGUAGE_NAME[y.WebSocketMessageBodyType.BINARY]},C={[y.WebSocketMessageBodySubType.BASE64]:S.USER_FRIENDLY_LANGUAGE_NAME[y.WebSocketMessageBodySubType.BASE64],[y.WebSocketMessageBodySubType.HEX]:S.USER_FRIENDLY_LANGUAGE_NAME[y.WebSocketMessageBodySubType.HEX]},M=[y.WebSocketMessageBodyType.TEXT,y.WebSocketMessageBodyType.BINARY],O={submit:"mod+enter"};const A=h.default.div.withConfig({displayName:"SocketIOCompose__AutoSuggestContainer",componentId:"postman-app__sc-h59y5v-0"})(["& .auto-suggest{& .auto-suggest-box{width:200px;font-family:var(--text-family-default);font-size:var(--text-size-m);color:var(--content-color-primary);border:var(--border-width-default) var(--border-style-solid) var(--content-color-tertiary);border-radius:var(--border-radius-default);padding:7.5px 10px;background-color:unset;transition:border-color 0.2s ease-in-out,box-shadow 0.2s ease-in-out;&:hover{border-color:var(--content-color-tertiary);background-color:unset;}}&.is-focused{& .public-DraftStyleDefault-block{white-space:nowrap !important;}.auto-suggest-box{border:"," !important;box-shadow:",";}}& .public-DraftStyleDefault-block{height:var(--size-xs) !important;white-space:nowrap !important;}}"],(({theme:e})=>"light"===e.name?"var(--border-width-default) var(--border-style-solid) var(--blue-30)":"var(--border-width-default) var(--border-style-solid) var(--blue-50)"),(({theme:e})=>"light"===e.name?"0 0 0 2px var(--blue-30)":"0 0 0 2px var(--blue-50)")),N=(0,T.c)(class extends a.Component{constructor(e){super(e),this.state={activeArg:0},this.getMessageEditor=this.getMessageEditor.bind(this),this.handleAddArgument=this.handleAddArgument.bind(this),this.handleArgUpdate=this.handleArgUpdate.bind(this),this.handleArgDelete=this.handleArgDelete.bind(this),this.handelArgValueChange=this.handelArgValueChange.bind(this),this.handleTypeChange=this.handleTypeChange.bind(this),this.handleSubTypeChange=this.handleSubTypeChange.bind(this),this.handleBeautify=this.handleBeautify.bind(this),this.handlePublishEventNameChange=this.handlePublishEventNameChange.bind(this),this.handleSend=this.handleSend.bind(this),this.handleActiveArgChange=this.handleActiveArgChange.bind(this),this.toggleAcknowledgement=this.toggleAcknowledgement.bind(this)}static getDerivedStateFromProps(e,t){const s=e.model.currentComposeMessage.get("args");return t.activeArg>=s.length?{activeArg:s.length-1}:null}getKeyMapHandlers(){return{submit:this.handleSend}}getMessageEditor(e,t){return a.createElement(c.default,{keyMap:O,handlers:this.getKeyMapHandlers()},a.createElement("div",{className:"socketIO-compose__multi-arg__editor","data-testid":"socketIO-compose-editor"},a.createElement(p.default,{fontSize:12,placeholder:"Compose message",onChange:this.handelArgValueChange.bind(this,t),language:this.showMessageSubTypes(e.type)?e.subtype:e.type,value:e.content,ref:e=>{this.editorRef=e},codeCompletionProviders:[{provider:m.default.bind(this)}]})))}showMessageSubTypes(e){return e===y.WebSocketMessageBodyType.BINARY}handleActiveArgChange(e){this.setState({activeArg:e})}handleAddArgument(){this.props.model.addArgument&&this.props.model.addArgument((e=>{this.handleActiveArgChange(e)}))}handleArgUpdate(e,t){this.props.model.updateArgument&&this.props.model.updateArgument(e,t)}handleArgDelete(e){this.props.model.deleteArgument&&this.props.model.deleteArgument(e)}handelArgValueChange(e,t){this.handleArgUpdate(e,{content:t})}handleTypeChange(e,t){const s={type:e};this.showMessageSubTypes(e)?null==t&&(s.subtype=y.WebSocketMessageBodySubType.BASE64):s.subtype=null,this.handleArgUpdate(this.state.activeArg,s)}handleSubTypeChange(e){this.handleArgUpdate(this.state.activeArg,{subtype:e})}handleBeautify(){this.editorRef&&this.editorRef.beautifyContent&&this.editorRef.beautifyContent()}handlePublishEventNameChange(e){this.props.model.updateEventName(e)}handleSend(){this.isSendDisabled||this.props.model.publish&&this.props.model.publish()}toggleAcknowledgement(){this.props.model.toggleAcknowledgement&&this.props.model.toggleAcknowledgement()}render(){let e;const{model:t}=this.props,s=t.currentComposeMessage.get("args"),{isDisabled:n,reason:i}=(0,_.isConnectDisabled)(t.type,t.url);this.isSendDisabled=!1,n?(this.isSendDisabled=!0,e=i):t.status!==S.CONNECTED&&t.status!==S.IDLE&&(this.isSendDisabled=!0);const o=window?f.includes(navigator.platform,"Mac"):"darwin"===v.platform,h=e||(o?"âŒ˜ â†µ":"Ctrl + Enter"),p=s[this.state.activeArg],m=p.type,y=p.subtype,T=this.showMessageSubTypes(m);return a.createElement("div",{className:"socketIO-compose"},a.createElement(g.default,{args:s,activeArg:this.state.activeArg,onActiveArgChange:this.handleActiveArgChange,onArgClose:this.handleArgDelete,className:"socketIO-compose__multi-arg",renderMessageContent:e=>this.getMessageEditor(s[e],e)}),a.createElement("div",{className:"socketIO-compose__footer"},a.createElement("div",{className:"socketIO-compose__footer__left"},a.createElement(r.default,{icon:"icon-action-add-stroke-small",text:"Arg",type:"tertiary",onClick:this.handleAddArgument}),a.createElement(E.default,{languageMap:b,activeLanguage:m,onChange:this.handleTypeChange}),T&&a.createElement(E.default,{languageMap:C,activeLanguage:y,onChange:this.handleSubTypeChange}),!f.includes(M,m)&&a.createElement(r.default,{onClick:this.handleBeautify,type:"tertiary",icon:"icon-action-pretty-stroke",tooltip:"Beautify"})),a.createElement("div",{className:"socketIO-compose__footer__right"},a.createElement(l.default,{isChecked:t.currentComposeMessage.get("acknowledgement"),onChange:this.toggleAcknowledgement,label:"Ack"}),a.createElement(c.default,{keyMap:O,handlers:this.getKeyMapHandlers()},a.createElement(A,null,a.createElement(d.AutoSuggestInput,{inputStyle:"box",placeholder:'Event name, defaults to "message"',allowFocus:!0,value:t.currentComposeMessage.get("eventName"),onChange:this.handlePublishEventNameChange,suggestions:(N=t.eventsCache.events,N?f.map(N,(e=>({value:e}))):[])}))),a.createElement(u.Button,{variant:t.status===S.CONNECTED?"cta":"secondary",tooltip:h,onClick:this.handleSend,isDisabled:this.isSendDisabled,"data-testid":"socketIO-sendMessage-button"},"Send"))));var N}},[n.observer]);t.default=N,N.contextTypes={variablesCache:o().object}},7414:function(e,t,s){s.r(t);var a=s(1),n=s(2098),i=s(4564),o=s(7403),r=s(7415),l=s(1821),c=s(12);const d=(0,l.c)(class extends a.Component{constructor(e){super(e),this.getListItem=this.getListItem.bind(this),this.handleMessageSelect=this.handleMessageSelect.bind(this),this.handleMediaSave=this.handleMediaSave.bind(this),this.handleListItemExpandAndCollapse=this.handleListItemExpandAndCollapse.bind(this)}getListItem(e,t){const{model:s}=this.props;return a.createElement(r.default,{key:t.id,index:e,message:t,color:s.eventsCache.getColor(c.get(t,"meta.eventName")),isSelected:s.selectedMessageSet.get(t.id),numberOfSelectedMessages:s.selectedMessageSet.size,cachedExpandedState:s.expandedMessageSet.get(t.id),mediaFilePath:s.messageMediaFilePaths.get(t.id),onMediaSave:this.handleMediaSave,toggleExpanded:this.handleListItemExpandAndCollapse,toggleMessageSelect:this.handleMessageSelect,saveMessage:s.saveMessageFromStream.bind(s),saveMessagesChecks:{isSavedRequest:s.isSavedRequest,isOnline:s.messageSDK.isOnline(),hasPermission:s.messageSDK.hasPermission(null,i.ItemAction.CREATE,!1,s.id)}})}handleMediaSave(e,t,s){this.props.model.saveMediaFilePath(e,t,s)}handleListItemExpandAndCollapse(e,t,s){this.props.model.toggleExpanded&&this.props.model.toggleExpanded(t,s),c.isNil(s)&&this.streamRef&&this.streamRef.handleResetHeight(e)}handleMessageSelect(e){this.props.model&&this.props.model.toggleMessageSelect(e)}render(){const{model:e}=this.props;return a.createElement(o.default,{ref:e=>{this.streamRef=e},model:e,renderListItem:this.getListItem,className:"socketIO-message-stream"})}},[n.observer]);t.default=d},7415:function(e,t,s){s.r(t);var a=s(1),n=s(2083),i=s.n(n),o=s(2098),r=s(1006),l=s(2102),c=s.n(l),d=s(2126),u=s(2802),h=s(3057),p=s(3060),m=s(2810),E=s(3825),g=s(5374),S=s(2112),_=s(3071),y=s(3077),T=s(3049),f=s(4994),v=s(7416),b=s(7412),C=s(4945),M=s(4944),O=s(4946),A=s(4947),N=s(1821),I=s(12);const w=(0,N.c)(class extends a.Component{constructor(e){super(e),this.state={isHovered:!1,forceEllipsifyPreview:!1},this.handleCopy=this.handleCopy.bind(this),this.handleSave=this.handleSave.bind(this),this.toggleSelect=this.toggleSelect.bind(this),this.toggleExpanded=this.toggleExpanded.bind(this),this.stopItemExpand=this.stopItemExpand.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.handleActiveArgChange=this.handleActiveArgChange.bind(this),this.getMessageBodyViewer=this.getMessageBodyViewer.bind(this),this.isPayloadEmpty=this.isPayloadEmpty.bind(this)}componentDidMount(){this.shouldForceEllipsifyPreview()}getClasses(e){return c()({"socketIO-stream-item":!0,"server-message":e===O.WEBSOCKET_INCOMING_MESSAGE,"client-message":e===O.WEBSOCKET_OUTGOING_MESSAGE,"no-body":this.isPayloadEmpty()})}getDataTestId(e){switch(e){case O.WEBSOCKET_INCOMING_MESSAGE:return"socketIO-server-message";case O.WEBSOCKET_OUTGOING_MESSAGE:return"socketIO-client-message"}}getPreviewMessageClasses(){return c()({"socketIO-stream-item__header__left-section__message":!0,"add-ellipsis":this.state.forceEllipsifyPreview,"is-placeholder":I.get(this.props.message,"meta.preview.placeholder")})}getMessageBodyViewer(e){const{value:t,meta:{mimeType:s,fileExtension:n}}=I.get(this.props.message,["payload",e]),i=O.MIME_TYPE_TO_MESSAGE_BODY_TYPE_MAP[s]||A.WebSocketMessageBodyType.TEXT,o=i===A.WebSocketMessageBodyType.HEXDUMP,r={activeLanguage:o?null:i,lineWrap:!1,hexMode:o};return a.createElement(b.default,{id:e,message:t,mimeType:s,fileExtension:n,mediaFilePath:I.get(this.props.mediaFilePath,[e]),cachedState:I.assign(r,I.get(this.props.cachedExpandedState,[e],{})),onMediaSave:this.handleMediaSave.bind(this,e),updateState:this.updateExpandedCachedState.bind(this,e)})}isPayloadEmpty(){return I.isEmpty(I.get(this.props.message,"payload"))}shouldForceEllipsifyPreview(){const e=this.previewRef;!I.get(this.props.message,"meta.preview.truncated")||!e||e.clientWidth<e.scrollWidth||this.setState({forceEllipsifyPreview:!0})}showCheckBox(e){return(e===O.WEBSOCKET_OUTGOING_MESSAGE||e===O.WEBSOCKET_INCOMING_MESSAGE)&&(this.state.isHovered||this.props.isSelected||this.props.numberOfSelectedMessages>0)}stopItemExpand(e){e&&e.stopPropagation()}toggleExpanded(){if(this.isPayloadEmpty())return;const{id:e}=this.props.message||{};this.props.toggleExpanded&&this.props.toggleExpanded(this.props.index,e)}updateExpandedCachedState(e,t){this.props.toggleExpanded&&this.props.toggleExpanded(this.props.index,this.props.message.id,{[e]:t})}toggleSelect(){const{id:e}=this.props.message||{};this.props.toggleMessageSelect&&this.props.toggleMessageSelect(e)}handleActiveArgChange(e){this.props.toggleExpanded&&this.props.toggleExpanded(this.props.index,this.props.message.id,{activeArg:e})}handleMediaSave(e,t){this.props.onMediaSave&&this.props.onMediaSave(this.props.message.id,e,t)}handleCopy(){const e=I.get(this.props.message,"payload"),{value:t}=I.first(e)||{};_.default.copy(t),pm.toasts.success("Copied to clipboard",{dedupeId:"message-copied-message"})}handleSave(){this.props.saveMessage&&(this.props.saveMessage((0,r.toJS)(this.props.message)),pm.toasts.success("Message saved",{dedupeId:"message-saved-message"}))}handleMouseEnter(){this.setState({isHovered:!0})}handleMouseLeave(){this.setState({isHovered:!1})}renderObjectInspector({error:e,handshakeDetails:t}){return a.createElement("div",{className:c()({"socketIO-stream-item__body__obj-inspector":!0,"no-details":I.isNil(t)})},e&&a.createElement("div",{className:"socketIO-stream-item__body__obj-inspector__error"},a.createElement(u.default,{type:"strong"},"Error:"),a.createElement("span",null," "),a.createElement(u.default,{type:"body-medium",color:"content-color-primary"},e)),t&&a.createElement(a.Fragment,null,a.createElement(h.default,{type:"h6",text:"Handshake Details",color:"content-color-secondary"}),a.createElement(y.default,{data:t})))}renderText(e){const{code:t,name:s,description:n}=e||{};let i;return t&&s?i=`${t} ${s}`:t?i=t:s&&(i=s),a.createElement("div",{className:"socketIO-stream-item__body__plain-text",title:n},i&&a.createElement(u.default,{type:"strong"},`${i}: `),a.createElement(u.default,{type:"body-medium",color:"content-color-secondary",className:"socketIO-stream-item__body__plain-text__description"},n))}renderBody(){if(this.isPayloadEmpty())return null;const{type:e,payload:t}=this.props.message||{};let s;switch(e){case O.WEBSOCKET_OUTGOING_MESSAGE:case O.WEBSOCKET_INCOMING_MESSAGE:s=a.createElement("div",{className:"socketIO-stream-item__body__message-body-viewer"},a.createElement(v.default,{args:t,activeArg:I.get(this.props.cachedExpandedState,"activeArg",0),onActiveArgChange:this.handleActiveArgChange,renderMessageContent:this.getMessageBodyViewer,readOnly:!0}));break;case O.WEBSOCKET_CONNECTED_MESSAGE:case O.WEBSOCKET_ERROR_MESSAGE:s=this.renderObjectInspector(t);break;case O.WEBSOCKET_DISCONNECTED_MESSAGE:default:s=this.renderText(t)}return a.createElement("div",{className:"socketIO-stream-item__body"},s)}renderHeaderRightSection(e,t={},s){const{time:n}=t,o=i()(n).format("HH:mm:ss"),{isSavedRequest:r,isOnline:l,hasPermission:c}=this.props.saveMessagesChecks||{},d=this.isPayloadEmpty()?null:a.createElement(S.default,{name:this.props.cachedExpandedState?"icon-direction-up":"icon-direction-down",color:"content-color-primary",size:"large"});let h=null;const E=o?a.createElement("div",{className:"socketIO-stream-item__header__right-section__time"},a.createElement(u.default,{type:"body-medium",color:"content-color-secondary"},o)):null;if(!this.state.isHovered||e!==O.WEBSOCKET_OUTGOING_MESSAGE&&e!==O.WEBSOCKET_INCOMING_MESSAGE)h=E;else{const e=!O.WEBSOCKET_MESSAGE_READABLE.has(I.get(s,[0,"meta","mimeType"]))||I.isEmpty(I.get(s,[0,"value"]));h=a.createElement(a.Fragment,null,a.createElement("div",{className:"socketIO-stream-item__header__right-section__quick-actions",onClick:this.stopItemExpand},a.createElement(p.default,{onClick:this.handleCopy,type:"tertiary",icon:"icon-action-copy-stroke",isDisabled:e,tooltip:a.createElement(m.default,{content:e?"Can't copy this message":"Copy "+(I.size(s)>1?"first argument":"message"),placement:"bottom"})}),a.createElement(p.default,{onClick:this.handleSave,type:"tertiary",icon:"icon-action-save-stroke",isDisabled:!l||!c||!r,tooltip:a.createElement(m.default,{content:l?r?c?"Save message":T.DISABLED_TOOLTIP_NO_PERMISSION:"Save this request to perform this action.":T.DISABLED_TOOLTIP_IS_OFFLINE,placement:"bottom"})})),E)}return a.createElement("div",{className:"socketIO-stream-item__header__right-section"},h,d)}renderHeader(){const{type:e,meta:t,payload:s}=this.props.message||{},n=O.MESSAGE_ICON_MAP[e]||O.MESSAGE_ICON_MAP.default||{},i=I.isFunction(n)?n((0,C.isNormalConnectionClose)(I.get(s,"name"))):n,{name:o,color:r,size:l}=i||{},d=t.eventName&&a.createElement(M.default,{name:t.eventName,color:this.props.color});let h;t&&(h=I.isString(t.preview)?t.preview:I.get(t.preview,"text"));const p=a.createElement(u.default,{type:"body-medium",className:this.getPreviewMessageClasses(),color:t.preview.placeholder?"content-color-secondary":"content-color-primary"},h),m=e===f.SOCKETIO_SUBSCRIBED_MESSAGE||e===f.SOCKETIO_UNSUBSCRIBED_MESSAGE?a.createElement(a.Fragment,null,p,d):a.createElement(a.Fragment,null,d,p);return a.createElement("div",{className:c()({"socketIO-stream-item__header":!0,"is-hovered":this.state.isHovered,"is-selected":this.props.isSelected}),onClick:this.toggleExpanded,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},a.createElement("div",{className:"socketIO-stream-item__header__left-section",ref:e=>{this.previewRef=e}},this.showCheckBox(e)&&a.createElement("div",{className:"socketIO-stream-item__header__left-section__checkbox",onClick:this.stopItemExpand},a.createElement(E.default,{isChecked:this.props.isSelected,onChange:this.toggleSelect,isDisabled:!this.props.isSelected&&2===this.props.numberOfSelectedMessages})),o&&r&&a.createElement("div",{className:"socketIO-stream-item__header__left-section__type-icon"},a.createElement(S.default,{name:o,color:r,size:l})),m,I.isArray(s)&&I.size(s)>1&&a.createElement("div",{className:"socketIO-stream-item__header__left-section__arg-count-badge"},a.createElement(g.default,{className:"badge",text:`+${I.size(s)-1} ${2===I.size(s)?"Arg":"Args"}`}))),this.renderHeaderRightSection(e,t,s))}render(){const{type:e}=this.props.message||{};return a.createElement("div",{className:this.getClasses(e),"data-testid":this.getDataTestId(e)},this.renderHeader(),Boolean(this.props.cachedExpandedState)&&this.renderBody())}},[o.observer]);t.default=(0,d.withTheme)(w)},7409:function(e,t,s){s.r(t),s.d(t,{default:function(){return i}});var a=s(1),n=s(3052);function i(){return a.createElement(n.default,{name:"illustration-connect-to-server"})}}}]);